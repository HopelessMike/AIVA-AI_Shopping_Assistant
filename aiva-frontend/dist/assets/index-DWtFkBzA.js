import{a as mr,b as es,g as hr,R as an,r as p,u as ct,c as ts,d as cn,e as rs,f as tt,B as ns}from"./react-vendor-s-cJrWiB.js";import{m as N,A as lt}from"./animation-DnWryeXm.js";import{M as We,S as ot,a as ss,b as _t,H as Ot,c as Ge,G as os,d as Pt,P as as,C as is,Z as ln,F as Or,e as cs,L as ls,X as at,T as un,f as dn,g as us,A as ds,h as fn,i as pn,j as fs,k as ps,R as ms,l as hs,m as Kt,n as mn,N as gs,V as hn,o as xs,U as ys,p as bs,q as ws}from"./ui-DimoD9uR.js";import{r as vs}from"./voice-BWufaHyz.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(o){if(o.ep)return;o.ep=!0;const a=r(o);fetch(o.href,a)}})();var Xt={exports:{}},rt={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pr;function Ss(){if(Pr)return rt;Pr=1;var e=mr(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,o=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function i(c,u,d){var l,f={},y=null,w=null;d!==void 0&&(y=""+d),u.key!==void 0&&(y=""+u.key),u.ref!==void 0&&(w=u.ref);for(l in u)n.call(u,l)&&!a.hasOwnProperty(l)&&(f[l]=u[l]);if(c&&c.defaultProps)for(l in u=c.defaultProps,u)f[l]===void 0&&(f[l]=u[l]);return{$$typeof:t,type:c,key:y,ref:w,props:f,_owner:o.current}}return rt.Fragment=r,rt.jsx=i,rt.jsxs=i,rt}var Ir;function js(){return Ir||(Ir=1,Xt.exports=Ss()),Xt.exports}var s=js(),vt={},zr;function Ns(){if(zr)return vt;zr=1;var e=es();return vt.createRoot=e.createRoot,vt.hydrateRoot=e.hydrateRoot,vt}var Cs=Ns();const Es=hr(Cs),Rs=({onVoiceToggle:e})=>s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-blue-50 to-indigo-100",children:[s.jsx(N.section,{className:"relative overflow-hidden py-20 px-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.8},children:s.jsx("div",{className:"max-w-7xl mx-auto",children:s.jsxs("div",{className:"relative z-10 text-center",children:[s.jsxs(N.h1,{className:"text-6xl md:text-7xl font-bold mb-8",initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.8},children:[s.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-blue-600",children:"Il Futuro dello Shopping"}),s.jsx("br",{}),s.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-purple-600",children:"è Vocale"})]}),s.jsx(N.p,{className:"text-xl md:text-2xl text-gray-700 mb-12 max-w-4xl mx-auto leading-relaxed",initial:{y:30,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4,duration:.8},children:"Scopri AIVA, il tuo personal shopper AI che ti aiuta a trovare l'outfit perfetto con comandi vocali in italiano."}),s.jsx(N.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.6,duration:.8,type:"spring",stiffness:200},className:"mb-16",children:s.jsxs(N.button,{onClick:e,className:"group relative px-12 py-6 bg-gradient-to-r from-purple-600 to-blue-600 text-white text-2xl font-bold rounded-full shadow-2xl hover:shadow-purple-500/25 transform transition-all duration-300",whileHover:{scale:1.05,boxShadow:"0 20px 40px rgba(147, 51, 234, 0.3)"},whileTap:{scale:.95},children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs(N.div,{className:"relative",animate:{rotate:[0,10,-10,0]},transition:{duration:2,repeat:1/0},children:[s.jsx(We,{size:32}),s.jsx(N.div,{className:"absolute -inset-2 bg-white/20 rounded-full",animate:{scale:[1,1.2,1]},transition:{duration:1.5,repeat:1/0}})]}),s.jsx("span",{children:"Inizia Shopping Vocale"}),s.jsx(ot,{size:24,className:"text-yellow-300"})]}),s.jsx(N.div,{className:"absolute inset-0 rounded-full bg-white/20",initial:{scale:0,opacity:1},animate:{scale:2,opacity:0},transition:{duration:1,repeat:1/0,delay:.5}})]})}),s.jsxs("div",{className:"absolute inset-0 pointer-events-none hidden md:block z-0",children:[s.jsx(N.div,{className:"absolute top-16 left-8 text-pink-400",animate:{y:[0,-15,0],rotate:[0,10,0]},transition:{duration:3,repeat:1/0},children:s.jsx(ss,{size:64})}),s.jsx(N.div,{className:"absolute top-24 right-12 text-purple-400",animate:{y:[0,20,0],rotate:[0,-8,0]},transition:{duration:4,repeat:1/0,delay:.5},children:s.jsx(_t,{size:56})}),s.jsx(N.div,{className:"absolute top-32 left-1/4 text-blue-400",animate:{y:[0,-10,0],rotate:[0,5,0]},transition:{duration:2.5,repeat:1/0,delay:1},children:s.jsx(Ot,{size:70})}),s.jsx(N.div,{className:"absolute top-48 right-8 text-green-400",animate:{y:[0,15,0],rotate:[0,-12,0]},transition:{duration:3.5,repeat:1/0,delay:.3},children:s.jsx(Ge,{size:60})}),s.jsx(N.div,{className:"absolute top-56 left-12 text-yellow-400",animate:{y:[0,-20,0],rotate:[0,8,0]},transition:{duration:2.8,repeat:1/0,delay:.8},children:s.jsx(os,{size:60})}),s.jsx(N.div,{className:"absolute top-64 right-1/3 text-red-400",animate:{y:[0,12,0],rotate:[0,-6,0]},transition:{duration:3.2,repeat:1/0,delay:1.2},children:"              "}),s.jsx(N.div,{className:"absolute bottom-48 left-16 text-indigo-400",animate:{y:[0,-18,0],rotate:[0,7,0]},transition:{duration:2.7,repeat:1/0,delay:.6},children:s.jsx(Pt,{size:50})}),s.jsx(N.div,{className:"absolute bottom-40 right-16 text-orange-400",animate:{y:[0,14,0],rotate:[0,-9,0]},transition:{duration:3.8,repeat:1/0,delay:1.1},children:s.jsx(as,{size:50})}),s.jsx(N.div,{className:"absolute bottom-32 left-1/3 text-cyan-400",animate:{y:[0,-16,0],rotate:[0,11,0]},transition:{duration:2.9,repeat:1/0,delay:.4}}),s.jsx(N.div,{className:"absolute bottom-24 right-1/4 text-rose-400",animate:{y:[0,22,0],rotate:[0,-7,0]},transition:{duration:3.3,repeat:1/0,delay:.9},children:s.jsx(is,{size:75})})]})]})})}),s.jsx(N.section,{className:"py-20 px-4 bg-white/50 backdrop-blur-sm",initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{delay:.8,duration:.8},children:s.jsxs("div",{className:"max-w-6xl mx-auto",children:[s.jsxs("div",{className:"text-center mb-16",children:[s.jsx("h2",{className:"text-4xl font-bold text-gray-800 mb-4",children:"Perché Scegliere AIVA"}),s.jsx("p",{className:"text-xl text-gray-600",children:"Un'esperienza di shopping rivoluzionaria"})]}),s.jsxs("div",{className:"grid md:grid-cols-3 gap-12",children:[s.jsxs(N.div,{className:"text-center p-8 bg-white/70 rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300",whileHover:{y:-5},children:[s.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center mx-auto mb-6",children:s.jsx(We,{size:40,className:"text-white"})}),s.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Comandi Vocali"}),s.jsx("p",{className:"text-gray-600 text-lg",children:"Cerca, filtra, apri le pagine e aggiungi al carrello con la voce"})]}),s.jsxs(N.div,{className:"text-center p-8 bg-white/70 rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300",whileHover:{y:-5},children:[s.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-full flex items-center justify-center mx-auto mb-6",children:s.jsx(ot,{size:40,className:"text-white"})}),s.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Risposte in Tempo Reale"}),s.jsx("p",{className:"text-gray-600 text-lg",children:"AIVA parla mentre elabora: risposte fluide e naturali, anche interruttibili"})]}),s.jsxs(N.div,{className:"text-center p-8 bg-white/70 rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300",whileHover:{y:-5},children:[s.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-emerald-500 to-teal-500 rounded-full flex items-center justify-center mx-auto mb-6",children:s.jsx(ln,{size:40,className:"text-white"})}),s.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Navigazione Istantanea"}),s.jsx("p",{className:"text-gray-600 text-lg",children:"Vai a Prodotti, Offerte o Carrello senza toccare lo schermo: basta dirlo"})]})]})]})}),s.jsx(N.section,{className:"py-20 px-4 bg-gradient-to-r from-purple-600 to-blue-600",initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{delay:1,duration:.8},children:s.jsx("div",{className:"max-w-4xl mx-auto text-center text-white",children:s.jsxs(N.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:1.2,duration:.8},children:[s.jsx("h2",{className:"text-4xl md:text-5xl font-bold mb-6",children:"Prova l'Esperienza Shopping del Futuro"}),s.jsx("p",{className:"text-xl md:text-2xl mb-8 opacity-90",children:'Clicca sul microfono e dì "Cerco una felpa nera" per iniziare'}),s.jsx(N.button,{onClick:e,className:"px-10 py-5 bg-white text-purple-600 font-bold text-xl rounded-full shadow-2xl hover:shadow-white/25 transform transition-all duration-300",whileHover:{scale:1.05,boxShadow:"0 20px 40px rgba(255, 255, 255, 0.3)"},whileTap:{scale:.95},children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(We,{size:28}),s.jsx("span",{children:"Attiva Assistente Vocale"})]})})]})})})]});function gn(e,t){return function(){return e.apply(t,arguments)}}const{toString:Ts}=Object.prototype,{getPrototypeOf:gr}=Object,{iterator:It,toStringTag:xn}=Symbol,zt=(e=>t=>{const r=Ts.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),ve=e=>(e=e.toLowerCase(),t=>zt(t)===e),Ft=e=>t=>typeof t===e,{isArray:Qe}=Array,Je=Ft("undefined");function ut(e){return e!==null&&!Je(e)&&e.constructor!==null&&!Je(e.constructor)&&fe(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const yn=ve("ArrayBuffer");function _s(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&yn(e.buffer),t}const As=Ft("string"),fe=Ft("function"),bn=Ft("number"),dt=e=>e!==null&&typeof e=="object",ks=e=>e===!0||e===!1,Ct=e=>{if(zt(e)!=="object")return!1;const t=gr(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(xn in e)&&!(It in e)},Os=e=>{if(!dt(e)||ut(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},Ps=ve("Date"),Is=ve("File"),zs=ve("Blob"),Fs=ve("FileList"),Ls=e=>dt(e)&&fe(e.pipe),Ds=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||fe(e.append)&&((t=zt(e))==="formdata"||t==="object"&&fe(e.toString)&&e.toString()==="[object FormData]"))},Us=ve("URLSearchParams"),[qs,Ms,$s,Bs]=["ReadableStream","Request","Response","Headers"].map(ve),Hs=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ft(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,o;if(typeof e!="object"&&(e=[e]),Qe(e))for(n=0,o=e.length;n<o;n++)t.call(null,e[n],n,e);else{if(ut(e))return;const a=r?Object.getOwnPropertyNames(e):Object.keys(e),i=a.length;let c;for(n=0;n<i;n++)c=a[n],t.call(null,e[c],c,e)}}function wn(e,t){if(ut(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,o;for(;n-- >0;)if(o=r[n],t===o.toLowerCase())return o;return null}const qe=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:globalThis,vn=e=>!Je(e)&&e!==qe;function ir(){const{caseless:e,skipUndefined:t}=vn(this)&&this||{},r={},n=(o,a)=>{const i=e&&wn(r,a)||a;Ct(r[i])&&Ct(o)?r[i]=ir(r[i],o):Ct(o)?r[i]=ir({},o):Qe(o)?r[i]=o.slice():(!t||!Je(o))&&(r[i]=o)};for(let o=0,a=arguments.length;o<a;o++)arguments[o]&&ft(arguments[o],n);return r}const Vs=(e,t,r,{allOwnKeys:n}={})=>(ft(t,(o,a)=>{r&&fe(o)?e[a]=gn(o,r):e[a]=o},{allOwnKeys:n}),e),Ws=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Js=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},Gs=(e,t,r,n)=>{let o,a,i;const c={};if(t=t||{},e==null)return t;do{for(o=Object.getOwnPropertyNames(e),a=o.length;a-- >0;)i=o[a],(!n||n(i,e,t))&&!c[i]&&(t[i]=e[i],c[i]=!0);e=r!==!1&&gr(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},Qs=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},Ks=e=>{if(!e)return null;if(Qe(e))return e;let t=e.length;if(!bn(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},Xs=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&gr(Uint8Array)),Ys=(e,t)=>{const n=(e&&e[It]).call(e);let o;for(;(o=n.next())&&!o.done;){const a=o.value;t.call(e,a[0],a[1])}},Zs=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},eo=ve("HTMLFormElement"),to=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,o){return n.toUpperCase()+o}),Fr=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),ro=ve("RegExp"),Sn=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};ft(r,(o,a)=>{let i;(i=t(o,a,e))!==!1&&(n[a]=i||o)}),Object.defineProperties(e,n)},no=e=>{Sn(e,(t,r)=>{if(fe(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(fe(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},so=(e,t)=>{const r={},n=o=>{o.forEach(a=>{r[a]=!0})};return Qe(e)?n(e):n(String(e).split(t)),r},oo=()=>{},ao=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function io(e){return!!(e&&fe(e.append)&&e[xn]==="FormData"&&e[It])}const co=e=>{const t=new Array(10),r=(n,o)=>{if(dt(n)){if(t.indexOf(n)>=0)return;if(ut(n))return n;if(!("toJSON"in n)){t[o]=n;const a=Qe(n)?[]:{};return ft(n,(i,c)=>{const u=r(i,o+1);!Je(u)&&(a[c]=u)}),t[o]=void 0,a}}return n};return r(e,0)},lo=ve("AsyncFunction"),uo=e=>e&&(dt(e)||fe(e))&&fe(e.then)&&fe(e.catch),jn=((e,t)=>e?setImmediate:t?((r,n)=>(qe.addEventListener("message",({source:o,data:a})=>{o===qe&&a===r&&n.length&&n.shift()()},!1),o=>{n.push(o),qe.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",fe(qe.postMessage)),fo=typeof queueMicrotask<"u"?queueMicrotask.bind(qe):typeof process<"u"&&process.nextTick||jn,po=e=>e!=null&&fe(e[It]),m={isArray:Qe,isArrayBuffer:yn,isBuffer:ut,isFormData:Ds,isArrayBufferView:_s,isString:As,isNumber:bn,isBoolean:ks,isObject:dt,isPlainObject:Ct,isEmptyObject:Os,isReadableStream:qs,isRequest:Ms,isResponse:$s,isHeaders:Bs,isUndefined:Je,isDate:Ps,isFile:Is,isBlob:zs,isRegExp:ro,isFunction:fe,isStream:Ls,isURLSearchParams:Us,isTypedArray:Xs,isFileList:Fs,forEach:ft,merge:ir,extend:Vs,trim:Hs,stripBOM:Ws,inherits:Js,toFlatObject:Gs,kindOf:zt,kindOfTest:ve,endsWith:Qs,toArray:Ks,forEachEntry:Ys,matchAll:Zs,isHTMLForm:eo,hasOwnProperty:Fr,hasOwnProp:Fr,reduceDescriptors:Sn,freezeMethods:no,toObjectSet:so,toCamelCase:to,noop:oo,toFiniteNumber:ao,findKey:wn,global:qe,isContextDefined:vn,isSpecCompliantForm:io,toJSONObject:co,isAsyncFn:lo,isThenable:uo,setImmediate:jn,asap:fo,isIterable:po};function F(e,t,r,n,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),o&&(this.response=o,this.status=o.status?o.status:null)}m.inherits(F,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:m.toJSONObject(this.config),code:this.code,status:this.status}}});const Nn=F.prototype,Cn={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Cn[e]={value:e}});Object.defineProperties(F,Cn);Object.defineProperty(Nn,"isAxiosError",{value:!0});F.from=(e,t,r,n,o,a)=>{const i=Object.create(Nn);m.toFlatObject(e,i,function(l){return l!==Error.prototype},d=>d!=="isAxiosError");const c=e&&e.message?e.message:"Error",u=t==null&&e?e.code:t;return F.call(i,c,u,r,n,o),e&&i.cause==null&&Object.defineProperty(i,"cause",{value:e,configurable:!0}),i.name=e&&e.name||"Error",a&&Object.assign(i,a),i};const mo=null;function cr(e){return m.isPlainObject(e)||m.isArray(e)}function En(e){return m.endsWith(e,"[]")?e.slice(0,-2):e}function Lr(e,t,r){return e?e.concat(t).map(function(o,a){return o=En(o),!r&&a?"["+o+"]":o}).join(r?".":""):t}function ho(e){return m.isArray(e)&&!e.some(cr)}const go=m.toFlatObject(m,{},null,function(t){return/^is[A-Z]/.test(t)});function Lt(e,t,r){if(!m.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=m.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(x,h){return!m.isUndefined(h[x])});const n=r.metaTokens,o=r.visitor||l,a=r.dots,i=r.indexes,u=(r.Blob||typeof Blob<"u"&&Blob)&&m.isSpecCompliantForm(t);if(!m.isFunction(o))throw new TypeError("visitor must be a function");function d(g){if(g===null)return"";if(m.isDate(g))return g.toISOString();if(m.isBoolean(g))return g.toString();if(!u&&m.isBlob(g))throw new F("Blob is not supported. Use a Buffer instead.");return m.isArrayBuffer(g)||m.isTypedArray(g)?u&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function l(g,x,h){let S=g;if(g&&!h&&typeof g=="object"){if(m.endsWith(x,"{}"))x=n?x:x.slice(0,-2),g=JSON.stringify(g);else if(m.isArray(g)&&ho(g)||(m.isFileList(g)||m.endsWith(x,"[]"))&&(S=m.toArray(g)))return x=En(x),S.forEach(function(_,L){!(m.isUndefined(_)||_===null)&&t.append(i===!0?Lr([x],L,a):i===null?x:x+"[]",d(_))}),!1}return cr(g)?!0:(t.append(Lr(h,x,a),d(g)),!1)}const f=[],y=Object.assign(go,{defaultVisitor:l,convertValue:d,isVisitable:cr});function w(g,x){if(!m.isUndefined(g)){if(f.indexOf(g)!==-1)throw Error("Circular reference detected in "+x.join("."));f.push(g),m.forEach(g,function(S,j){(!(m.isUndefined(S)||S===null)&&o.call(t,S,m.isString(j)?j.trim():j,x,y))===!0&&w(S,x?x.concat(j):[j])}),f.pop()}}if(!m.isObject(e))throw new TypeError("data must be an object");return w(e),t}function Dr(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function xr(e,t){this._pairs=[],e&&Lt(e,this,t)}const Rn=xr.prototype;Rn.append=function(t,r){this._pairs.push([t,r])};Rn.toString=function(t){const r=t?function(n){return t.call(this,n,Dr)}:Dr;return this._pairs.map(function(o){return r(o[0])+"="+r(o[1])},"").join("&")};function xo(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Tn(e,t,r){if(!t)return e;const n=r&&r.encode||xo;m.isFunction(r)&&(r={serialize:r});const o=r&&r.serialize;let a;if(o?a=o(t,r):a=m.isURLSearchParams(t)?t.toString():new xr(t,r).toString(n),a){const i=e.indexOf("#");i!==-1&&(e=e.slice(0,i)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}class Ur{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){m.forEach(this.handlers,function(n){n!==null&&t(n)})}}const _n={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},yo=typeof URLSearchParams<"u"?URLSearchParams:xr,bo=typeof FormData<"u"?FormData:null,wo=typeof Blob<"u"?Blob:null,vo={isBrowser:!0,classes:{URLSearchParams:yo,FormData:bo,Blob:wo},protocols:["http","https","file","blob","url","data"]},yr=typeof window<"u"&&typeof document<"u",lr=typeof navigator=="object"&&navigator||void 0,So=yr&&(!lr||["ReactNative","NativeScript","NS"].indexOf(lr.product)<0),jo=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",No=yr&&window.location.href||"http://localhost",Co=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:yr,hasStandardBrowserEnv:So,hasStandardBrowserWebWorkerEnv:jo,navigator:lr,origin:No},Symbol.toStringTag,{value:"Module"})),ae={...Co,...vo};function Eo(e,t){return Lt(e,new ae.classes.URLSearchParams,{visitor:function(r,n,o,a){return ae.isNode&&m.isBuffer(r)?(this.append(n,r.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...t})}function Ro(e){return m.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function To(e){const t={},r=Object.keys(e);let n;const o=r.length;let a;for(n=0;n<o;n++)a=r[n],t[a]=e[a];return t}function An(e){function t(r,n,o,a){let i=r[a++];if(i==="__proto__")return!0;const c=Number.isFinite(+i),u=a>=r.length;return i=!i&&m.isArray(o)?o.length:i,u?(m.hasOwnProp(o,i)?o[i]=[o[i],n]:o[i]=n,!c):((!o[i]||!m.isObject(o[i]))&&(o[i]=[]),t(r,n,o[i],a)&&m.isArray(o[i])&&(o[i]=To(o[i])),!c)}if(m.isFormData(e)&&m.isFunction(e.entries)){const r={};return m.forEachEntry(e,(n,o)=>{t(Ro(n),o,r,0)}),r}return null}function _o(e,t,r){if(m.isString(e))try{return(t||JSON.parse)(e),m.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const pt={transitional:_n,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",o=n.indexOf("application/json")>-1,a=m.isObject(t);if(a&&m.isHTMLForm(t)&&(t=new FormData(t)),m.isFormData(t))return o?JSON.stringify(An(t)):t;if(m.isArrayBuffer(t)||m.isBuffer(t)||m.isStream(t)||m.isFile(t)||m.isBlob(t)||m.isReadableStream(t))return t;if(m.isArrayBufferView(t))return t.buffer;if(m.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let c;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return Eo(t,this.formSerializer).toString();if((c=m.isFileList(t))||n.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return Lt(c?{"files[]":t}:t,u&&new u,this.formSerializer)}}return a||o?(r.setContentType("application/json",!1),_o(t)):t}],transformResponse:[function(t){const r=this.transitional||pt.transitional,n=r&&r.forcedJSONParsing,o=this.responseType==="json";if(m.isResponse(t)||m.isReadableStream(t))return t;if(t&&m.isString(t)&&(n&&!this.responseType||o)){const i=!(r&&r.silentJSONParsing)&&o;try{return JSON.parse(t,this.parseReviver)}catch(c){if(i)throw c.name==="SyntaxError"?F.from(c,F.ERR_BAD_RESPONSE,this,null,this.response):c}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ae.classes.FormData,Blob:ae.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};m.forEach(["delete","get","head","post","put","patch"],e=>{pt.headers[e]={}});const Ao=m.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),ko=e=>{const t={};let r,n,o;return e&&e.split(`
`).forEach(function(i){o=i.indexOf(":"),r=i.substring(0,o).trim().toLowerCase(),n=i.substring(o+1).trim(),!(!r||t[r]&&Ao[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},qr=Symbol("internals");function nt(e){return e&&String(e).trim().toLowerCase()}function Et(e){return e===!1||e==null?e:m.isArray(e)?e.map(Et):String(e)}function Oo(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const Po=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Yt(e,t,r,n,o){if(m.isFunction(n))return n.call(this,t,r);if(o&&(t=r),!!m.isString(t)){if(m.isString(n))return t.indexOf(n)!==-1;if(m.isRegExp(n))return n.test(t)}}function Io(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function zo(e,t){const r=m.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(o,a,i){return this[n].call(this,t,o,a,i)},configurable:!0})})}let pe=class{constructor(t){t&&this.set(t)}set(t,r,n){const o=this;function a(c,u,d){const l=nt(u);if(!l)throw new Error("header name must be a non-empty string");const f=m.findKey(o,l);(!f||o[f]===void 0||d===!0||d===void 0&&o[f]!==!1)&&(o[f||u]=Et(c))}const i=(c,u)=>m.forEach(c,(d,l)=>a(d,l,u));if(m.isPlainObject(t)||t instanceof this.constructor)i(t,r);else if(m.isString(t)&&(t=t.trim())&&!Po(t))i(ko(t),r);else if(m.isObject(t)&&m.isIterable(t)){let c={},u,d;for(const l of t){if(!m.isArray(l))throw TypeError("Object iterator must return a key-value pair");c[d=l[0]]=(u=c[d])?m.isArray(u)?[...u,l[1]]:[u,l[1]]:l[1]}i(c,r)}else t!=null&&a(r,t,n);return this}get(t,r){if(t=nt(t),t){const n=m.findKey(this,t);if(n){const o=this[n];if(!r)return o;if(r===!0)return Oo(o);if(m.isFunction(r))return r.call(this,o,n);if(m.isRegExp(r))return r.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=nt(t),t){const n=m.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||Yt(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let o=!1;function a(i){if(i=nt(i),i){const c=m.findKey(n,i);c&&(!r||Yt(n,n[c],c,r))&&(delete n[c],o=!0)}}return m.isArray(t)?t.forEach(a):a(t),o}clear(t){const r=Object.keys(this);let n=r.length,o=!1;for(;n--;){const a=r[n];(!t||Yt(this,this[a],a,t,!0))&&(delete this[a],o=!0)}return o}normalize(t){const r=this,n={};return m.forEach(this,(o,a)=>{const i=m.findKey(n,a);if(i){r[i]=Et(o),delete r[a];return}const c=t?Io(a):String(a).trim();c!==a&&delete r[a],r[c]=Et(o),n[c]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return m.forEach(this,(n,o)=>{n!=null&&n!==!1&&(r[o]=t&&m.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(o=>n.set(o)),n}static accessor(t){const n=(this[qr]=this[qr]={accessors:{}}).accessors,o=this.prototype;function a(i){const c=nt(i);n[c]||(zo(o,i),n[c]=!0)}return m.isArray(t)?t.forEach(a):a(t),this}};pe.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);m.reduceDescriptors(pe.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});m.freezeMethods(pe);function Zt(e,t){const r=this||pt,n=t||r,o=pe.from(n.headers);let a=n.data;return m.forEach(e,function(c){a=c.call(r,a,o.normalize(),t?t.status:void 0)}),o.normalize(),a}function kn(e){return!!(e&&e.__CANCEL__)}function Ke(e,t,r){F.call(this,e??"canceled",F.ERR_CANCELED,t,r),this.name="CanceledError"}m.inherits(Ke,F,{__CANCEL__:!0});function On(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new F("Request failed with status code "+r.status,[F.ERR_BAD_REQUEST,F.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function Fo(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Lo(e,t){e=e||10;const r=new Array(e),n=new Array(e);let o=0,a=0,i;return t=t!==void 0?t:1e3,function(u){const d=Date.now(),l=n[a];i||(i=d),r[o]=u,n[o]=d;let f=a,y=0;for(;f!==o;)y+=r[f++],f=f%e;if(o=(o+1)%e,o===a&&(a=(a+1)%e),d-i<t)return;const w=l&&d-l;return w?Math.round(y*1e3/w):void 0}}function Do(e,t){let r=0,n=1e3/t,o,a;const i=(d,l=Date.now())=>{r=l,o=null,a&&(clearTimeout(a),a=null),e(...d)};return[(...d)=>{const l=Date.now(),f=l-r;f>=n?i(d,l):(o=d,a||(a=setTimeout(()=>{a=null,i(o)},n-f)))},()=>o&&i(o)]}const At=(e,t,r=3)=>{let n=0;const o=Lo(50,250);return Do(a=>{const i=a.loaded,c=a.lengthComputable?a.total:void 0,u=i-n,d=o(u),l=i<=c;n=i;const f={loaded:i,total:c,progress:c?i/c:void 0,bytes:u,rate:d||void 0,estimated:d&&c&&l?(c-i)/d:void 0,event:a,lengthComputable:c!=null,[t?"download":"upload"]:!0};e(f)},r)},Mr=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},$r=e=>(...t)=>m.asap(()=>e(...t)),Uo=ae.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,ae.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(ae.origin),ae.navigator&&/(msie|trident)/i.test(ae.navigator.userAgent)):()=>!0,qo=ae.hasStandardBrowserEnv?{write(e,t,r,n,o,a){const i=[e+"="+encodeURIComponent(t)];m.isNumber(r)&&i.push("expires="+new Date(r).toGMTString()),m.isString(n)&&i.push("path="+n),m.isString(o)&&i.push("domain="+o),a===!0&&i.push("secure"),document.cookie=i.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Mo(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function $o(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Pn(e,t,r){let n=!Mo(t);return e&&(n||r==!1)?$o(e,t):t}const Br=e=>e instanceof pe?{...e}:e;function $e(e,t){t=t||{};const r={};function n(d,l,f,y){return m.isPlainObject(d)&&m.isPlainObject(l)?m.merge.call({caseless:y},d,l):m.isPlainObject(l)?m.merge({},l):m.isArray(l)?l.slice():l}function o(d,l,f,y){if(m.isUndefined(l)){if(!m.isUndefined(d))return n(void 0,d,f,y)}else return n(d,l,f,y)}function a(d,l){if(!m.isUndefined(l))return n(void 0,l)}function i(d,l){if(m.isUndefined(l)){if(!m.isUndefined(d))return n(void 0,d)}else return n(void 0,l)}function c(d,l,f){if(f in t)return n(d,l);if(f in e)return n(void 0,d)}const u={url:a,method:a,data:a,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:c,headers:(d,l,f)=>o(Br(d),Br(l),f,!0)};return m.forEach(Object.keys({...e,...t}),function(l){const f=u[l]||o,y=f(e[l],t[l],l);m.isUndefined(y)&&f!==c||(r[l]=y)}),r}const In=e=>{const t=$e({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:o,xsrfCookieName:a,headers:i,auth:c}=t;if(t.headers=i=pe.from(i),t.url=Tn(Pn(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),c&&i.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):""))),m.isFormData(r)){if(ae.hasStandardBrowserEnv||ae.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(m.isFunction(r.getHeaders)){const u=r.getHeaders(),d=["content-type","content-length"];Object.entries(u).forEach(([l,f])=>{d.includes(l.toLowerCase())&&i.set(l,f)})}}if(ae.hasStandardBrowserEnv&&(n&&m.isFunction(n)&&(n=n(t)),n||n!==!1&&Uo(t.url))){const u=o&&a&&qo.read(a);u&&i.set(o,u)}return t},Bo=typeof XMLHttpRequest<"u",Ho=Bo&&function(e){return new Promise(function(r,n){const o=In(e);let a=o.data;const i=pe.from(o.headers).normalize();let{responseType:c,onUploadProgress:u,onDownloadProgress:d}=o,l,f,y,w,g;function x(){w&&w(),g&&g(),o.cancelToken&&o.cancelToken.unsubscribe(l),o.signal&&o.signal.removeEventListener("abort",l)}let h=new XMLHttpRequest;h.open(o.method.toUpperCase(),o.url,!0),h.timeout=o.timeout;function S(){if(!h)return;const _=pe.from("getAllResponseHeaders"in h&&h.getAllResponseHeaders()),$={data:!c||c==="text"||c==="json"?h.responseText:h.response,status:h.status,statusText:h.statusText,headers:_,config:e,request:h};On(function(k){r(k),x()},function(k){n(k),x()},$),h=null}"onloadend"in h?h.onloadend=S:h.onreadystatechange=function(){!h||h.readyState!==4||h.status===0&&!(h.responseURL&&h.responseURL.indexOf("file:")===0)||setTimeout(S)},h.onabort=function(){h&&(n(new F("Request aborted",F.ECONNABORTED,e,h)),h=null)},h.onerror=function(L){const $=L&&L.message?L.message:"Network Error",A=new F($,F.ERR_NETWORK,e,h);A.event=L||null,n(A),h=null},h.ontimeout=function(){let L=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const $=o.transitional||_n;o.timeoutErrorMessage&&(L=o.timeoutErrorMessage),n(new F(L,$.clarifyTimeoutError?F.ETIMEDOUT:F.ECONNABORTED,e,h)),h=null},a===void 0&&i.setContentType(null),"setRequestHeader"in h&&m.forEach(i.toJSON(),function(L,$){h.setRequestHeader($,L)}),m.isUndefined(o.withCredentials)||(h.withCredentials=!!o.withCredentials),c&&c!=="json"&&(h.responseType=o.responseType),d&&([y,g]=At(d,!0),h.addEventListener("progress",y)),u&&h.upload&&([f,w]=At(u),h.upload.addEventListener("progress",f),h.upload.addEventListener("loadend",w)),(o.cancelToken||o.signal)&&(l=_=>{h&&(n(!_||_.type?new Ke(null,e,h):_),h.abort(),h=null)},o.cancelToken&&o.cancelToken.subscribe(l),o.signal&&(o.signal.aborted?l():o.signal.addEventListener("abort",l)));const j=Fo(o.url);if(j&&ae.protocols.indexOf(j)===-1){n(new F("Unsupported protocol "+j+":",F.ERR_BAD_REQUEST,e));return}h.send(a||null)})},Vo=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,o;const a=function(d){if(!o){o=!0,c();const l=d instanceof Error?d:this.reason;n.abort(l instanceof F?l:new Ke(l instanceof Error?l.message:l))}};let i=t&&setTimeout(()=>{i=null,a(new F(`timeout ${t} of ms exceeded`,F.ETIMEDOUT))},t);const c=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(d=>{d.unsubscribe?d.unsubscribe(a):d.removeEventListener("abort",a)}),e=null)};e.forEach(d=>d.addEventListener("abort",a));const{signal:u}=n;return u.unsubscribe=()=>m.asap(c),u}},Wo=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,o;for(;n<r;)o=n+t,yield e.slice(n,o),n=o},Jo=async function*(e,t){for await(const r of Go(e))yield*Wo(r,t)},Go=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},Hr=(e,t,r,n)=>{const o=Jo(e,t);let a=0,i,c=u=>{i||(i=!0,n&&n(u))};return new ReadableStream({async pull(u){try{const{done:d,value:l}=await o.next();if(d){c(),u.close();return}let f=l.byteLength;if(r){let y=a+=f;r(y)}u.enqueue(new Uint8Array(l))}catch(d){throw c(d),d}},cancel(u){return c(u),o.return()}},{highWaterMark:2})},Vr=64*1024,{isFunction:St}=m,Qo=(({Request:e,Response:t})=>({Request:e,Response:t}))(m.global),{ReadableStream:Wr,TextEncoder:Jr}=m.global,Gr=(e,...t)=>{try{return!!e(...t)}catch{return!1}},Ko=e=>{e=m.merge.call({skipUndefined:!0},Qo,e);const{fetch:t,Request:r,Response:n}=e,o=t?St(t):typeof fetch=="function",a=St(r),i=St(n);if(!o)return!1;const c=o&&St(Wr),u=o&&(typeof Jr=="function"?(g=>x=>g.encode(x))(new Jr):async g=>new Uint8Array(await new r(g).arrayBuffer())),d=a&&c&&Gr(()=>{let g=!1;const x=new r(ae.origin,{body:new Wr,method:"POST",get duplex(){return g=!0,"half"}}).headers.has("Content-Type");return g&&!x}),l=i&&c&&Gr(()=>m.isReadableStream(new n("").body)),f={stream:l&&(g=>g.body)};o&&["text","arrayBuffer","blob","formData","stream"].forEach(g=>{!f[g]&&(f[g]=(x,h)=>{let S=x&&x[g];if(S)return S.call(x);throw new F(`Response type '${g}' is not supported`,F.ERR_NOT_SUPPORT,h)})});const y=async g=>{if(g==null)return 0;if(m.isBlob(g))return g.size;if(m.isSpecCompliantForm(g))return(await new r(ae.origin,{method:"POST",body:g}).arrayBuffer()).byteLength;if(m.isArrayBufferView(g)||m.isArrayBuffer(g))return g.byteLength;if(m.isURLSearchParams(g)&&(g=g+""),m.isString(g))return(await u(g)).byteLength},w=async(g,x)=>{const h=m.toFiniteNumber(g.getContentLength());return h??y(x)};return async g=>{let{url:x,method:h,data:S,signal:j,cancelToken:_,timeout:L,onDownloadProgress:$,onUploadProgress:A,responseType:k,headers:T,withCredentials:P="same-origin",fetchOptions:D}=In(g),X=t||fetch;k=k?(k+"").toLowerCase():"text";let G=Vo([j,_&&_.toAbortSignal()],L),ie=null;const re=G&&G.unsubscribe&&(()=>{G.unsubscribe()});let Se;try{if(A&&d&&h!=="get"&&h!=="head"&&(Se=await w(T,S))!==0){let E=new r(x,{method:"POST",body:S,duplex:"half"}),C;if(m.isFormData(S)&&(C=E.headers.get("content-type"))&&T.setContentType(C),E.body){const[B,W]=Mr(Se,At($r(A)));S=Hr(E.body,Vr,B,W)}}m.isString(P)||(P=P?"include":"omit");const ne=a&&"credentials"in r.prototype,Xe={...D,signal:G,method:h.toUpperCase(),headers:T.normalize().toJSON(),body:S,duplex:"half",credentials:ne?P:void 0};ie=a&&new r(x,Xe);let se=await(a?X(ie,D):X(x,Xe));const Ie=l&&(k==="stream"||k==="response");if(l&&($||Ie&&re)){const E={};["status","statusText","headers"].forEach(O=>{E[O]=se[O]});const C=m.toFiniteNumber(se.headers.get("content-length")),[B,W]=$&&Mr(C,At($r($),!0))||[];se=new n(Hr(se.body,Vr,B,()=>{W&&W(),re&&re()}),E)}k=k||"text";let Q=await f[m.findKey(f,k)||"text"](se,g);return!Ie&&re&&re(),await new Promise((E,C)=>{On(E,C,{data:Q,headers:pe.from(se.headers),status:se.status,statusText:se.statusText,config:g,request:ie})})}catch(ne){throw re&&re(),ne&&ne.name==="TypeError"&&/Load failed|fetch/i.test(ne.message)?Object.assign(new F("Network Error",F.ERR_NETWORK,g,ie),{cause:ne.cause||ne}):F.from(ne,ne&&ne.code,g,ie)}}},Xo=new Map,zn=e=>{let t=e?e.env:{};const{fetch:r,Request:n,Response:o}=t,a=[n,o,r];let i=a.length,c=i,u,d,l=Xo;for(;c--;)u=a[c],d=l.get(u),d===void 0&&l.set(u,d=c?new Map:Ko(t)),l=d;return d};zn();const ur={http:mo,xhr:Ho,fetch:{get:zn}};m.forEach(ur,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Qr=e=>`- ${e}`,Yo=e=>m.isFunction(e)||e===null||e===!1,Fn={getAdapter:(e,t)=>{e=m.isArray(e)?e:[e];const{length:r}=e;let n,o;const a={};for(let i=0;i<r;i++){n=e[i];let c;if(o=n,!Yo(n)&&(o=ur[(c=String(n)).toLowerCase()],o===void 0))throw new F(`Unknown adapter '${c}'`);if(o&&(m.isFunction(o)||(o=o.get(t))))break;a[c||"#"+i]=o}if(!o){const i=Object.entries(a).map(([u,d])=>`adapter ${u} `+(d===!1?"is not supported by the environment":"is not available in the build"));let c=r?i.length>1?`since :
`+i.map(Qr).join(`
`):" "+Qr(i[0]):"as no adapter specified";throw new F("There is no suitable adapter to dispatch the request "+c,"ERR_NOT_SUPPORT")}return o},adapters:ur};function er(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Ke(null,e)}function Kr(e){return er(e),e.headers=pe.from(e.headers),e.data=Zt.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Fn.getAdapter(e.adapter||pt.adapter,e)(e).then(function(n){return er(e),n.data=Zt.call(e,e.transformResponse,n),n.headers=pe.from(n.headers),n},function(n){return kn(n)||(er(e),n&&n.response&&(n.response.data=Zt.call(e,e.transformResponse,n.response),n.response.headers=pe.from(n.response.headers))),Promise.reject(n)})}const Ln="1.12.2",Dt={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Dt[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const Xr={};Dt.transitional=function(t,r,n){function o(a,i){return"[Axios v"+Ln+"] Transitional option '"+a+"'"+i+(n?". "+n:"")}return(a,i,c)=>{if(t===!1)throw new F(o(i," has been removed"+(r?" in "+r:"")),F.ERR_DEPRECATED);return r&&!Xr[i]&&(Xr[i]=!0,console.warn(o(i," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(a,i,c):!0}};Dt.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function Zo(e,t,r){if(typeof e!="object")throw new F("options must be an object",F.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let o=n.length;for(;o-- >0;){const a=n[o],i=t[a];if(i){const c=e[a],u=c===void 0||i(c,a,e);if(u!==!0)throw new F("option "+a+" must be "+u,F.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new F("Unknown option "+a,F.ERR_BAD_OPTION)}}const Rt={assertOptions:Zo,validators:Dt},Te=Rt.validators;let Me=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Ur,response:new Ur}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const a=o.stack?o.stack.replace(/^.+\n/,""):"";try{n.stack?a&&!String(n.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+a):n.stack=a}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=$e(this.defaults,r);const{transitional:n,paramsSerializer:o,headers:a}=r;n!==void 0&&Rt.assertOptions(n,{silentJSONParsing:Te.transitional(Te.boolean),forcedJSONParsing:Te.transitional(Te.boolean),clarifyTimeoutError:Te.transitional(Te.boolean)},!1),o!=null&&(m.isFunction(o)?r.paramsSerializer={serialize:o}:Rt.assertOptions(o,{encode:Te.function,serialize:Te.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Rt.assertOptions(r,{baseUrl:Te.spelling("baseURL"),withXsrfToken:Te.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let i=a&&m.merge(a.common,a[r.method]);a&&m.forEach(["delete","get","head","post","put","patch","common"],g=>{delete a[g]}),r.headers=pe.concat(i,a);const c=[];let u=!0;this.interceptors.request.forEach(function(x){typeof x.runWhen=="function"&&x.runWhen(r)===!1||(u=u&&x.synchronous,c.unshift(x.fulfilled,x.rejected))});const d=[];this.interceptors.response.forEach(function(x){d.push(x.fulfilled,x.rejected)});let l,f=0,y;if(!u){const g=[Kr.bind(this),void 0];for(g.unshift(...c),g.push(...d),y=g.length,l=Promise.resolve(r);f<y;)l=l.then(g[f++],g[f++]);return l}y=c.length;let w=r;for(;f<y;){const g=c[f++],x=c[f++];try{w=g(w)}catch(h){x.call(this,h);break}}try{l=Kr.call(this,w)}catch(g){return Promise.reject(g)}for(f=0,y=d.length;f<y;)l=l.then(d[f++],d[f++]);return l}getUri(t){t=$e(this.defaults,t);const r=Pn(t.baseURL,t.url,t.allowAbsoluteUrls);return Tn(r,t.params,t.paramsSerializer)}};m.forEach(["delete","get","head","options"],function(t){Me.prototype[t]=function(r,n){return this.request($e(n||{},{method:t,url:r,data:(n||{}).data}))}});m.forEach(["post","put","patch"],function(t){function r(n){return function(a,i,c){return this.request($e(c||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:a,data:i}))}}Me.prototype[t]=r(),Me.prototype[t+"Form"]=r(!0)});let ea=class Dn{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(a){r=a});const n=this;this.promise.then(o=>{if(!n._listeners)return;let a=n._listeners.length;for(;a-- >0;)n._listeners[a](o);n._listeners=null}),this.promise.then=o=>{let a;const i=new Promise(c=>{n.subscribe(c),a=c}).then(o);return i.cancel=function(){n.unsubscribe(a)},i},t(function(a,i,c){n.reason||(n.reason=new Ke(a,i,c),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new Dn(function(o){t=o}),cancel:t}}};function ta(e){return function(r){return e.apply(null,r)}}function ra(e){return m.isObject(e)&&e.isAxiosError===!0}const dr={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(dr).forEach(([e,t])=>{dr[t]=e});function Un(e){const t=new Me(e),r=gn(Me.prototype.request,t);return m.extend(r,Me.prototype,t,{allOwnKeys:!0}),m.extend(r,t,null,{allOwnKeys:!0}),r.create=function(o){return Un($e(e,o))},r}const M=Un(pt);M.Axios=Me;M.CanceledError=Ke;M.CancelToken=ea;M.isCancel=kn;M.VERSION=Ln;M.toFormData=Lt;M.AxiosError=F;M.Cancel=M.CanceledError;M.all=function(t){return Promise.all(t)};M.spread=ta;M.isAxiosError=ra;M.mergeConfig=$e;M.AxiosHeaders=pe;M.formToJSON=e=>An(m.isHTMLForm(e)?new FormData(e):e);M.getAdapter=Fn.getAdapter;M.HttpStatusCode=dr;M.default=M;const{Axios:ei,AxiosError:ti,CanceledError:ri,isCancel:ni,CancelToken:si,VERSION:oi,all:ai,Cancel:ii,isAxiosError:ci,spread:li,toFormData:ui,AxiosHeaders:di,HttpStatusCode:fi,formToJSON:pi,getAdapter:mi,mergeConfig:hi}=M,qn="http://localhost:8000",he=M.create({baseURL:qn,timeout:1e4,headers:{"Content-Type":"application/json"}});he.interceptors.request.use(e=>{var t;return console.log(`API Request: ${(t=e.method)==null?void 0:t.toUpperCase()} ${e.url}`),e},e=>(console.error("API Request Error:",e),Promise.reject(e)));he.interceptors.response.use(e=>(console.log(`API Response: ${e.status} ${e.config.url}`),e),e=>{var t;return console.error("API Response Error:",((t=e.response)==null?void 0:t.data)||e.message),e.code==="ECONNREFUSED"||e.message.includes("Network Error")?(console.warn("Backend not available, using mock data"),{data:[]}):Promise.reject(e)});const Ut={getProducts:async(e={})=>{try{return(await he.get("/api/products",{params:e})).data}catch(t){if(console.error("Error fetching products:",t),t.code==="ECONNREFUSED"||t.message.includes("Network Error"))return kt();throw t}},getSizeGuide:async e=>(await he.get(`/api/size-guide/${encodeURIComponent(e)}`)).data,getProduct:async e=>{try{return(await he.get(`/api/products/${e}`)).data}catch(t){if(console.error("Error fetching product:",t),t.code==="ECONNREFUSED"||t.message.includes("Network Error"))return oa(e);throw t}},checkAvailability:async(e,t,r)=>{try{return(await he.get(`/api/products/${e}/availability`,{params:{size:t,color:r}})).data}catch(n){return console.error("Error checking availability:",n),{available:!0,stock:10}}},getRecommendations:async(e={})=>{try{return(await he.get("/api/recommendations",{params:e})).data}catch(t){if(console.error("Error fetching recommendations:",t),t.code==="ECONNREFUSED"||t.message.includes("Network Error"))return aa();throw t}},searchProducts:async(e,t={})=>{try{const r={q:e,...t};return(await he.get("/api/products",{params:r})).data}catch(r){if(console.error("Error searching products:",r),r.code==="ECONNREFUSED"||r.message.includes("Network Error"))return kt().filter(n=>n.name.toLowerCase().includes(e.toLowerCase())||n.brand.toLowerCase().includes(e.toLowerCase()));throw r}}},na={getCart:async()=>{try{return(await he.get("/api/cart")).data}catch(e){throw console.error("Error fetching cart:",e),e}},addToCart:async(e,t,r,n=1)=>{try{return(await he.post("/api/cart/items",{product_id:e,size:t,color:r,quantity:n})).data}catch(o){throw console.error("Error adding to cart:",o),o}},removeFromCart:async e=>{try{return(await he.delete(`/api/cart/items/${e}`)).data}catch(t){throw console.error("Error removing from cart:",t),t}},updateQuantity:async(e,t)=>{try{return(await he.put(`/api/cart/items/${e}`,{quantity:t})).data}catch(r){throw console.error("Error updating quantity:",r),r}},clearCart:async()=>{try{return(await he.post("/api/cart/clear")).data}catch(e){throw console.error("Error clearing cart:",e),e}}},sa=e=>{const t=`${qn.replace("http","ws")}/ws/${e}`;return new WebSocket(t)},kt=()=>[{id:"550e8400-0001-41d4-a716-446655440001",name:"T-Shirt Basic Cotone Bio",brand:"EcoWear",price:19.9,original_price:29.9,discount_percentage:33,images:["https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?w=400"],rating:4.6,reviews:234,category:"t-shirt",variants:[{size:"S",color:"bianco",stock:10},{size:"M",color:"bianco",stock:15},{size:"L",color:"bianco",stock:8}]},{id:"550e8400-0002-41d4-a716-446655440002",name:"Felpa con Cappuccio",brand:"Street Urban",price:59.9,original_price:79.9,discount_percentage:25,images:["https://images.unsplash.com/photo-1556821840-3a63f95609a7?w=400"],rating:4.8,reviews:312,category:"felpa",variants:[{size:"M",color:"nero",stock:12},{size:"L",color:"nero",stock:10},{size:"XL",color:"nero",stock:5}]},{id:"550e8400-0003-41d4-a716-446655440003",name:"Jeans Slim Fit",brand:"Denim Co",price:79.9,original_price:99.9,discount_percentage:20,images:["https://images.unsplash.com/photo-1542272604-787c3835535d?w=400"],rating:4.7,reviews:456,category:"pantaloni",variants:[{size:"30",color:"blu",stock:8},{size:"32",color:"blu",stock:15},{size:"34",color:"blu",stock:12}]}],oa=e=>{const t=kt();return t.find(r=>r.id===e)||t[0]},aa=()=>kt().slice(0,3),Mn="/ldr-icons";function ia(){return typeof window>"u"?!1:window.location.pathname.startsWith(Mn)}function ca(e){const t=e.startsWith("/")?e:`/${e}`;return typeof window<"u"&&ia()?`${Mn}${t}`:t}function la(e){return ca(e)}function fr(e){if(!e)return e;const t=String(e);return t.startsWith("http://")||t.startsWith("https://")||t.startsWith("data:")?t:la(t)}const ua={},Yr=e=>{let t;const r=new Set,n=(l,f)=>{const y=typeof l=="function"?l(t):l;if(!Object.is(y,t)){const w=t;t=f??(typeof y!="object"||y===null)?y:Object.assign({},t,y),r.forEach(g=>g(t,w))}},o=()=>t,u={setState:n,getState:o,getInitialState:()=>d,subscribe:l=>(r.add(l),()=>r.delete(l)),destroy:()=>{(ua?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},d=t=e(n,o,u);return u},da=e=>e?Yr(e):Yr;var tr={exports:{}},rr={},nr={exports:{}},sr={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zr;function fa(){if(Zr)return sr;Zr=1;var e=mr();function t(f,y){return f===y&&(f!==0||1/f===1/y)||f!==f&&y!==y}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,o=e.useEffect,a=e.useLayoutEffect,i=e.useDebugValue;function c(f,y){var w=y(),g=n({inst:{value:w,getSnapshot:y}}),x=g[0].inst,h=g[1];return a(function(){x.value=w,x.getSnapshot=y,u(x)&&h({inst:x})},[f,w,y]),o(function(){return u(x)&&h({inst:x}),f(function(){u(x)&&h({inst:x})})},[f]),i(w),w}function u(f){var y=f.getSnapshot;f=f.value;try{var w=y();return!r(f,w)}catch{return!0}}function d(f,y){return y()}var l=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:c;return sr.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:l,sr}var en;function pa(){return en||(en=1,nr.exports=fa()),nr.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tn;function ma(){if(tn)return rr;tn=1;var e=mr(),t=pa();function r(d,l){return d===l&&(d!==0||1/d===1/l)||d!==d&&l!==l}var n=typeof Object.is=="function"?Object.is:r,o=t.useSyncExternalStore,a=e.useRef,i=e.useEffect,c=e.useMemo,u=e.useDebugValue;return rr.useSyncExternalStoreWithSelector=function(d,l,f,y,w){var g=a(null);if(g.current===null){var x={hasValue:!1,value:null};g.current=x}else x=g.current;g=c(function(){function S(A){if(!j){if(j=!0,_=A,A=y(A),w!==void 0&&x.hasValue){var k=x.value;if(w(k,A))return L=k}return L=A}if(k=L,n(_,A))return k;var T=y(A);return w!==void 0&&w(k,T)?(_=A,k):(_=A,L=T)}var j=!1,_,L,$=f===void 0?null:f;return[function(){return S(l())},$===null?void 0:function(){return S($())}]},[l,f,y,w]);var h=o(d,g[0],g[1]);return i(function(){x.hasValue=!0,x.value=h},[h]),u(h),h},rr}var rn;function ha(){return rn||(rn=1,tr.exports=ma()),tr.exports}var ga=ha();const xa=hr(ga),$n={},{useDebugValue:ya}=an,{useSyncExternalStoreWithSelector:ba}=xa;let nn=!1;const wa=e=>e;function va(e,t=wa,r){($n?"production":void 0)!=="production"&&r&&!nn&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),nn=!0);const n=ba(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return ya(n),n}const sn=e=>{($n?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?da(e):e,r=(n,o)=>va(t,n,o);return Object.assign(r,t),r},Sa=e=>e?sn(e):sn,Tt={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_BACKEND_URL:"http://localhost:8000",VITE_DEBUG_MODE:"false",VITE_DEFAULT_LANGUAGE:"it-IT",VITE_ENABLE_ANALYTICS:"false",VITE_ENABLE_VOICE:"true",VITE_ENABLE_WEBSOCKET:"true",VITE_PRIMARY_COLOR:"",VITE_PUBLIC_URL:"http://localhost:5173",VITE_SECONDARY_COLOR:"",VITE_SUPPORTED_LANGUAGES:"it-IT,en-US",VITE_THEME:"light",VITE_TTS_LANGUAGE:"it-IT",VITE_TTS_PITCH:"1.0",VITE_TTS_RATE:"1.0",VITE_VOICE_RECOGNITION_LANGUAGE:"it-IT",VITE_WS_URL:"ws://localhost:8000"},pr=new Map,jt=e=>{const t=pr.get(e);return t?Object.fromEntries(Object.entries(t.stores).map(([r,n])=>[r,n.getState()])):{}},ja=(e,t,r)=>{if(e===void 0)return{type:"untracked",connection:t.connect(r)};const n=pr.get(r.name);if(n)return{type:"tracked",store:e,...n};const o={connection:t.connect(r),stores:{}};return pr.set(r.name,o),{type:"tracked",store:e,...o}},Na=(e,t={})=>(r,n,o)=>{const{enabled:a,anonymousActionType:i,store:c,...u}=t;let d;try{d=(a??(Tt?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!d)return(Tt?"production":void 0)!=="production"&&a&&console.warn("[zustand devtools middleware] Please install/enable Redux devtools extension"),e(r,n,o);const{connection:l,...f}=ja(c,d,u);let y=!0;o.setState=(x,h,S)=>{const j=r(x,h);if(!y)return j;const _=S===void 0?{type:i||"anonymous"}:typeof S=="string"?{type:S}:S;return c===void 0?(l==null||l.send(_,n()),j):(l==null||l.send({..._,type:`${c}/${_.type}`},{...jt(u.name),[c]:o.getState()}),j)};const w=(...x)=>{const h=y;y=!1,r(...x),y=h},g=e(o.setState,n,o);if(f.type==="untracked"?l==null||l.init(g):(f.stores[f.store]=o,l==null||l.init(Object.fromEntries(Object.entries(f.stores).map(([x,h])=>[x,x===f.store?g:h.getState()])))),o.dispatchFromDevtools&&typeof o.dispatch=="function"){let x=!1;const h=o.dispatch;o.dispatch=(...S)=>{(Tt?"production":void 0)!=="production"&&S[0].type==="__setState"&&!x&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),x=!0),h(...S)}}return l.subscribe(x=>{var h;switch(x.type){case"ACTION":if(typeof x.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return or(x.payload,S=>{if(S.type==="__setState"){if(c===void 0){w(S.state);return}Object.keys(S.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format. 
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const j=S.state[c];if(j==null)return;JSON.stringify(o.getState())!==JSON.stringify(j)&&w(j);return}o.dispatchFromDevtools&&typeof o.dispatch=="function"&&o.dispatch(S)});case"DISPATCH":switch(x.payload.type){case"RESET":return w(g),c===void 0?l==null?void 0:l.init(o.getState()):l==null?void 0:l.init(jt(u.name));case"COMMIT":if(c===void 0){l==null||l.init(o.getState());return}return l==null?void 0:l.init(jt(u.name));case"ROLLBACK":return or(x.state,S=>{if(c===void 0){w(S),l==null||l.init(o.getState());return}w(S[c]),l==null||l.init(jt(u.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return or(x.state,S=>{if(c===void 0){w(S);return}JSON.stringify(o.getState())!==JSON.stringify(S[c])&&w(S[c])});case"IMPORT_STATE":{const{nextLiftedState:S}=x.payload,j=(h=S.computedStates.slice(-1)[0])==null?void 0:h.state;if(!j)return;w(c===void 0?j:j[c]),l==null||l.send(null,S);return}case"PAUSE_RECORDING":return y=!y}return}}),g},Ca=Na,or=(e,t)=>{let r;try{r=JSON.parse(e)}catch(n){console.error("[zustand devtools middleware] Could not parse the received json",n)}r!==void 0&&t(r)};function Ea(e,t){let r;try{r=e()}catch{return}return{getItem:o=>{var a;const i=u=>u===null?null:JSON.parse(u,void 0),c=(a=r.getItem(o))!=null?a:null;return c instanceof Promise?c.then(i):i(c)},setItem:(o,a)=>r.setItem(o,JSON.stringify(a,void 0)),removeItem:o=>r.removeItem(o)}}const it=e=>t=>{try{const r=e(t);return r instanceof Promise?r:{then(n){return it(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return it(n)(r)}}}},Ra=(e,t)=>(r,n,o)=>{let a={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:h=>h,version:0,merge:(h,S)=>({...S,...h}),...t},i=!1;const c=new Set,u=new Set;let d;try{d=a.getStorage()}catch{}if(!d)return e((...h)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),r(...h)},n,o);const l=it(a.serialize),f=()=>{const h=a.partialize({...n()});let S;const j=l({state:h,version:a.version}).then(_=>d.setItem(a.name,_)).catch(_=>{S=_});if(S)throw S;return j},y=o.setState;o.setState=(h,S)=>{y(h,S),f()};const w=e((...h)=>{r(...h),f()},n,o);let g;const x=()=>{var h;if(!d)return;i=!1,c.forEach(j=>j(n()));const S=((h=a.onRehydrateStorage)==null?void 0:h.call(a,n()))||void 0;return it(d.getItem.bind(d))(a.name).then(j=>{if(j)return a.deserialize(j)}).then(j=>{if(j)if(typeof j.version=="number"&&j.version!==a.version){if(a.migrate)return a.migrate(j.state,j.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return j.state}).then(j=>{var _;return g=a.merge(j,(_=n())!=null?_:w),r(g,!0),f()}).then(()=>{S==null||S(g,void 0),i=!0,u.forEach(j=>j(g))}).catch(j=>{S==null||S(void 0,j)})};return o.persist={setOptions:h=>{a={...a,...h},h.getStorage&&(d=h.getStorage())},clearStorage:()=>{d==null||d.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>x(),hasHydrated:()=>i,onHydrate:h=>(c.add(h),()=>{c.delete(h)}),onFinishHydration:h=>(u.add(h),()=>{u.delete(h)})},x(),g||w},Ta=(e,t)=>(r,n,o)=>{let a={storage:Ea(()=>localStorage),partialize:x=>x,version:0,merge:(x,h)=>({...h,...x}),...t},i=!1;const c=new Set,u=new Set;let d=a.storage;if(!d)return e((...x)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),r(...x)},n,o);const l=()=>{const x=a.partialize({...n()});return d.setItem(a.name,{state:x,version:a.version})},f=o.setState;o.setState=(x,h)=>{f(x,h),l()};const y=e((...x)=>{r(...x),l()},n,o);o.getInitialState=()=>y;let w;const g=()=>{var x,h;if(!d)return;i=!1,c.forEach(j=>{var _;return j((_=n())!=null?_:y)});const S=((h=a.onRehydrateStorage)==null?void 0:h.call(a,(x=n())!=null?x:y))||void 0;return it(d.getItem.bind(d))(a.name).then(j=>{if(j)if(typeof j.version=="number"&&j.version!==a.version){if(a.migrate)return[!0,a.migrate(j.state,j.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,j.state];return[!1,void 0]}).then(j=>{var _;const[L,$]=j;if(w=a.merge($,(_=n())!=null?_:y),r(w,!0),L)return l()}).then(()=>{S==null||S(w,void 0),w=n(),i=!0,u.forEach(j=>j(w))}).catch(j=>{S==null||S(void 0,j)})};return o.persist={setOptions:x=>{a={...a,...x},x.storage&&(d=x.storage)},clearStorage:()=>{d==null||d.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>g(),hasHydrated:()=>i,onHydrate:x=>(c.add(x),()=>{c.delete(x)}),onFinishHydration:x=>(u.add(x),()=>{u.delete(x)})},a.skipHydration||g(),w||y},_a=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((Tt?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Ra(e,t)):Ta(e,t),Aa=_a,ka=e=>(e||"").toString().normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").toLowerCase().replace(/[^a-z0-9]+/g," ").trim(),st=e=>{if(typeof window>"u")return;const t=(e||[]).map(n=>{var o,a,i;return{item_id:n.id,product_id:(o=n.product)==null?void 0:o.id,name:(a=n.product)==null?void 0:a.name,size:n.size,color:n.color,quantity:n.quantity,price:(i=n.product)==null?void 0:i.price}}),r={};for(const n of t){const o=ka(`${n.name} ${n.size||""} ${n.color||""}`);o&&(r[o]=n.item_id)}window.cartSnapshot=t,window.cartItemsMap=r},ge=Sa(Ca(Aa((e,t)=>({cart:[],cartTotal:0,cartCount:0,preferences:{size:null,color:null,gender:null,style:null},isVoiceAssistantOpen:!1,isMobileMenuOpen:!1,isCartOpen:!1,currentPage:"home",voiceHistory:[],isListening:!1,products:[],filteredProducts:[],selectedProduct:null,searchQuery:"",activeFilters:{category:null,gender:null,size:null,color:null,minPrice:0,maxPrice:1e3,onSale:!1,brand:null,style:null},addToCart:(r,n,o,a=1)=>{e(i=>{const c=i.cart.find(f=>f.product.id===r.id&&f.size===n&&f.color===o);let u;c?u=i.cart.map(f=>f===c?{...f,quantity:f.quantity+a}:f):u=[...i.cart,{id:`cart-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,product:r,size:n,color:o,quantity:a,addedAt:new Date().toISOString()}];const d=u.reduce((f,y)=>f+y.product.price*y.quantity,0),l=u.reduce((f,y)=>f+y.quantity,0);return st(u),{cart:u,cartTotal:d,cartCount:l}})},removeFromCart:r=>{e(n=>{const o=n.cart.filter(c=>c.id!==r),a=o.reduce((c,u)=>c+u.product.price*u.quantity,0),i=o.reduce((c,u)=>c+u.quantity,0);return st(o),{cart:o,cartTotal:a,cartCount:i}})},clearCart:()=>{e({cart:[],cartTotal:0,cartCount:0}),st([])},updateQuantity:(r,n)=>{if(n<=0){t().removeFromCart(r);return}e(o=>{const a=o.cart.map(u=>u.id===r?{...u,quantity:n}:u),i=a.reduce((u,d)=>u+d.product.price*d.quantity,0),c=a.reduce((u,d)=>u+d.quantity,0);return st(a),{cart:a,cartTotal:i,cartCount:c}})},setCartFromServer:r=>{const n=Array.isArray(r==null?void 0:r.items)?r.items:[];e({cart:n,cartTotal:(r==null?void 0:r.grand_total)??(r==null?void 0:r.total)??0,cartCount:(r==null?void 0:r.item_count)??n.reduce((o,a)=>o+(a.quantity||0),0)}),st(n)},setPreferences:r=>{e(n=>({preferences:{...n.preferences,...r}}))},updatePreference:(r,n)=>{e(o=>({preferences:{...o.preferences,[r]:n}}))},setCurrentPage:r=>e({currentPage:r}),toggleVoiceAssistant:()=>{e(r=>({isVoiceAssistantOpen:!r.isVoiceAssistantOpen}))},addVoiceHistory:r=>{e(n=>({voiceHistory:[...n.voiceHistory,{...r,timestamp:new Date().toISOString(),id:`voice-${Date.now()}`}].slice(-50)}))},clearVoiceHistory:()=>e({voiceHistory:[]}),setProducts:r=>{e({products:r,filteredProducts:r})},setSearchQuery:r=>{e(n=>{const o=r.toLowerCase();if(!r)return{searchQuery:"",filteredProducts:n.products};const a={maglia:["maglia","maglietta","t-shirt","polo"],felpa:["felpa","hoodie","felpa con cappuccio"],pantaloni:["pantaloni","jeans","denim","chino"],scarpe:["scarpe","sneakers","stivali","sandali"],giacca:["giacca","giubbotto","bomber","cappotto"]};let i=[o];for(const[u,d]of Object.entries(a))d.some(l=>o.includes(l))&&(i=[...i,...d]);const c=n.products.filter(u=>{const d=[u.name,u.description,u.brand,u.category,u.subcategory,...u.tags||[]].join(" ").toLowerCase();return i.some(l=>d.includes(l))});return{searchQuery:r,filteredProducts:c}})},setFilter:(r,n)=>{e(o=>{const a={...o.activeFilters,[r]:n},i=t().applyFilters(o.products,a,o.searchQuery);return{activeFilters:a,filteredProducts:i}})},setMultipleFilters:r=>{e(n=>{const o={...n.activeFilters,...r},a=t().applyFilters(n.products,o,n.searchQuery);return{activeFilters:o,filteredProducts:a}})},clearFilters:()=>{e(r=>({activeFilters:{category:null,gender:null,size:null,color:null,minPrice:0,maxPrice:1e3,onSale:!1,brand:null,style:null},filteredProducts:r.products,searchQuery:""}))},applyFilters:(r,n,o="")=>{let a=[...r];if(o){const i=o.toLowerCase();a=a.filter(c=>[c.name,c.description,c.brand,c.category,c.subcategory,...c.tags||[]].join(" ").toLowerCase().includes(i))}return n.category&&(a=a.filter(i=>i.category===n.category||i.subcategory===n.category)),n.gender&&(a=a.filter(i=>i.gender===n.gender||i.gender==="unisex")),n.size&&(a=a.filter(i=>i.variants&&i.variants.some(c=>c.size===n.size&&c.available))),n.color&&(a=a.filter(i=>i.variants&&i.variants.some(c=>c.color.toLowerCase().includes(n.color.toLowerCase())))),n.minPrice>0&&(a=a.filter(i=>i.price>=n.minPrice)),n.maxPrice<1e3&&(a=a.filter(i=>i.price<=n.maxPrice)),n.onSale&&(a=a.filter(i=>i.on_sale||i.discount_percentage>0)),n.brand&&(a=a.filter(i=>i.brand.toLowerCase().includes(n.brand.toLowerCase()))),n.style&&(a=a.filter(i=>i.style&&i.style.toLowerCase().includes(n.style.toLowerCase()))),a},filterProducts:r=>{e(n=>{const o={...n.activeFilters,...r},a=t().applyFilters(n.products,o,n.searchQuery);return{activeFilters:o,filteredProducts:a}})},searchProducts:(r,n={})=>{e(o=>{const a={...o.activeFilters,...n},i=t().applyFilters(o.products,a,r);return{searchQuery:r,activeFilters:a,filteredProducts:i}})},setSelectedProduct:r=>e({selectedProduct:r}),getProductById:r=>t().products.find(o=>o.id===r),isProductInCart:(r,n=null,o=null)=>t().cart.some(i=>{const c=i.product.id===r,u=!n||i.size===n,d=!o||i.color===o;return c&&u&&d}),getCartItemCount:(r,n=null,o=null)=>{const i=t().cart.find(c=>{const u=c.product.id===r,d=!n||c.size===n,l=!o||c.color===o;return u&&d&&l});return i?i.quantity:0},processVoiceCommand:(r,n)=>{switch(t(),r){case"search_products":n.query&&t().searchProducts(n.query,n.filters||{});break;case"add_to_cart":if(n.product_id){const o=t().getProductById(n.product_id);o&&t().addToCart(o,n.size||"M",n.color||"nero",n.quantity||1)}break;case"clear_cart":t().clearCart();break;case"set_preferences":n.preferences&&t().setPreferences(n.preferences);break;default:console.log("Unknown voice command:",r)}t().addVoiceHistory({command:r,parameters:n,result:"processed"})},getShoppingInsights:()=>{const r=t(),n=r.cartTotal,o=r.cartCount,a=r.voiceHistory.filter(c=>c.command==="search_products").map(c=>{var u;return(u=c.parameters)==null?void 0:u.query}).filter(Boolean),i=r.preferences.size||(r.cart.length>0?r.cart[0].size:null);return{totalSpent:n,itemsInCart:o,favoriteCategories:a,preferredSize:i,searchHistory:r.voiceHistory.slice(-10),lastUpdated:new Date().toISOString()}}}),{name:"aiva-storage",partialize:e=>({cart:e.cart,cartTotal:e.cartTotal,cartCount:e.cartCount,preferences:e.preferences,voiceHistory:e.voiceHistory.slice(-20)})}),{name:"aiva-store"})),Pe="http://localhost:8000";function Oa(e){return(e||"").toString().normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").toLowerCase().replace(/[^a-z0-9]+/g," ").trim()}async function Nt(){try{const e=await M.get(`${Pe}/api/cart`),t=ge.getState().setCartFromServer;typeof t=="function"&&t(e.data)}catch(e){console.warn("Cart sync from server failed:",(e==null?void 0:e.message)||e)}}function Ue(e){try{const t=(e||[]).map(n=>{var o,a,i;return{item_id:n.id,product_id:(o=n.product)==null?void 0:o.id,name:(a=n.product)==null?void 0:a.name,size:n.size,color:n.color,quantity:n.quantity,price:(i=n.product)==null?void 0:i.price}}),r={};for(const n of t){const o=Oa(`${n.name} ${n.size||""} ${n.color||""}`);o&&(r[o]=n.item_id)}window.cartSnapshot=t,window.cartItemsMap=r,window.dispatchEvent(new CustomEvent("aiva-cart-changed",{detail:t}))}catch{}}function on(e=5){var t;try{const r=ge.getState(),n=Array.isArray(r.cart)?r.cart:[];if(n.length===0)return"Il carrello è vuoto.";const o=[];for(let c=0;c<Math.min(n.length,e);c++){const u=n[c],d=((t=u==null?void 0:u.product)==null?void 0:t.name)||"prodotto",l=(u==null?void 0:u.quantity)||1,f=u!=null&&u.size?`, taglia ${u.size}`:"",y=u!=null&&u.color?`, ${u.color}`:"";o.push(`${l} x ${d}${f}${y}`)}const a=n.length-Math.min(n.length,e),i=a>0?`, e altri ${a} articoli.`:".";return`Nel carrello ci sono: ${o.join(". ")}${i}`}catch{return"Il carrello è vuoto."}}const mt=()=>{const{cart:e,cartTotal:t,cartCount:r,addToCart:n,removeFromCart:o,clearCart:a,updateQuantity:i}=ge(),[c,u]=p.useState(!1),[d,l]=p.useState(null),[f,y]=p.useState(0);p.useEffect(()=>{t>=100?y(0):r>0?y(9.9):y(0)},[t,r]),p.useEffect(()=>{Ue(e)},[e]);const w=p.useCallback(async(T,P,D,X=1)=>{try{if(u(!0),l(null),!(await M.get(`${Pe}/api/products/${T.id}/availability`,{params:{size:P,color:D}})).data.available)throw new Error("Variante non disponibile");return n(T,P,D,X),Ue(ge.getState().cart),await M.post(`${Pe}/api/cart/items`,{product_id:T.id,size:P,color:D,quantity:X}),await Nt(),!0}catch(G){return l(G.message||"Errore aggiunta al carrello"),console.error("Add to cart error:",G),!1}finally{u(!1)}},[n]),g=p.useCallback(async T=>{try{return u(!0),l(null),o(T),Ue(ge.getState().cart),await M.delete(`${Pe}/api/cart/items/${T}`),await Nt(),!0}catch(P){return l(P.message||"Errore rimozione dal carrello"),console.error("Remove from cart error:",P),!1}finally{u(!1)}},[o]),x=p.useCallback(async()=>{if(e.length===0)return l("Il carrello è vuoto"),!1;const T=e[e.length-1];return g(T.id)},[e,g]),h=p.useCallback(async T=>{try{u(!0),l(null);const P=e.filter(D=>D.product.category.toLowerCase()===T.toLowerCase());if(P.length===0)return l(`Nessun prodotto della categoria ${T} nel carrello`),!1;for(const D of P)o(D.id);return Ue(ge.getState().cart),await M.post(`${Pe}/api/cart/remove-category`,{category:T}),!0}catch(P){return l(P.message||"Errore rimozione categoria"),!1}finally{u(!1)}},[e,o]),S=p.useCallback(async(T,P)=>{if(P<1||P>10)return l("Quantità deve essere tra 1 e 10"),!1;try{return u(!0),l(null),i(T,P),Ue(ge.getState().cart),await M.put(`${Pe}/api/cart/items/${T}`,{quantity:P}),await Nt(),!0}catch(D){return l(D.message||"Errore aggiornamento quantità"),!1}finally{u(!1)}},[i]),j=p.useCallback(async(T,P=1)=>{const D=e.find(G=>G.id===T);if(!D)return l("Prodotto non trovato nel carrello"),!1;const X=D.quantity+P;return S(T,X)},[e,S]),_=p.useCallback(async(T,P=1)=>{const D=e.find(G=>G.id===T);if(!D)return l("Prodotto non trovato nel carrello"),!1;const X=D.quantity-P;return X<=0?g(T):S(T,X)},[e,S,g]),L=p.useCallback(async()=>{try{return u(!0),l(null),a(),Ue(ge.getState().cart),await M.post(`${Pe}/api/cart/clear`),await Nt(),!0}catch(T){return l(T.message||"Errore svuotamento carrello"),!1}finally{u(!1)}},[a]),$=p.useCallback(()=>{const T=t,P=f,D=T+P;return{items:e,itemCount:r,subtotal:T,shipping:P,total:D}},[e,r,t,f]),A=p.useCallback((T,P=null,D=null)=>e.some(X=>{const G=X.product.id===T,ie=!P||X.size===P,re=!D||X.color===D;return G&&ie&&re}),[e]),k=p.useCallback((T,P=null,D=null)=>{const X=e.find(G=>{const ie=G.product.id===T,re=!P||G.size===P,Se=!D||G.color===D;return ie&&re&&Se});return X?X.quantity:0},[e]);return p.useEffect(()=>{(async()=>{try{const P=await M.get(`${Pe}/api/cart`),D=ge.getState().setCartFromServer;typeof D=="function"&&D(P.data)}catch(P){console.error("Failed to sync cart:",P)}})()},[]),{cart:e,cartCount:r,cartTotal:t,shipping:f,grandTotal:t+f,loading:c,error:d,addToCart:w,removeFromCart:g,removeLastItem:x,removeByCategory:h,updateQuantity:S,increaseQuantity:j,decreaseQuantity:_,clearCart:L,getCartSummary:$,isInCart:A,getItemQuantity:k}},Bn=()=>{const[e,t]=p.useState([]),[r,n]=p.useState(!1);p.useEffect(()=>{const l=localStorage.getItem("aiva-favorites");if(l)try{t(JSON.parse(l))}catch(f){console.error("Error loading favorites:",f),t([])}},[]),p.useEffect(()=>{localStorage.setItem("aiva-favorites",JSON.stringify(e))},[e]);const o=p.useCallback(l=>{t(f=>f.some(w=>w.id===l.id)?f:[...f,l])},[]),a=p.useCallback(l=>{t(f=>f.filter(y=>y.id!==l))},[]),i=p.useCallback(l=>{e.some(y=>y.id===l.id)?a(l.id):o(l)},[e,o,a]),c=p.useCallback(l=>e.some(f=>f.id===l),[e]),u=p.useCallback(()=>{t([])},[]),d=e.length;return{favorites:e,favoritesCount:d,addToFavorites:o,removeFromFavorites:a,toggleFavorite:i,isFavorite:c,clearFavorites:u,loading:r}},Pa=({product:e,onAddToCart:t,onToggleFavorite:r,isFavorite:n})=>{var u;const[o,a]=p.useState(!1),i=ct(),c=()=>{i(`/products/${e.id}`)};return s.jsxs(N.div,{className:"bg-white rounded-xl shadow-sm overflow-hidden cursor-pointer",whileHover:{y:-8,shadow:"xl"},transition:{type:"spring",stiffness:300},onHoverStart:()=>a(!0),onHoverEnd:()=>a(!1),onClick:c,children:[s.jsxs("div",{className:"relative overflow-hidden h-72 bg-gray-100",children:[s.jsx(N.img,{src:fr(((u=e.images)==null?void 0:u[0])||e.image||"/static/images/placeholder.jpg"),alt:e.name,className:"w-full h-full object-cover",animate:{scale:o?1.1:1},transition:{duration:.3}}),(()=>{const d=Number(e.discount_percentage??e.discount??0),l=Number(e.original_price??e.originalPrice??0),f=Number(e.price??0);return d>0&&l>f})()&&s.jsxs(N.div,{className:"absolute top-4 left-4 bg-red-500 text-white px-3 py-1 rounded-full text-sm font-bold",initial:{rotate:-15},animate:{rotate:o?0:-15},children:["-",Number(e.discount_percentage??e.discount??0),"%"]}),s.jsx(N.div,{className:"absolute top-4 right-4",whileHover:{scale:1.2},whileTap:{scale:.9},onClick:d=>{d.stopPropagation(),r(e)},children:s.jsx("button",{className:`p-2 rounded-full shadow-md transition-colors ${n?"bg-red-500 text-white hover:bg-red-600":"bg-white text-gray-600 hover:bg-gray-100"}`,children:s.jsx(Ot,{size:20,fill:n?"currentColor":"none"})})})]}),s.jsxs("div",{className:"p-4",children:[s.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider mb-1",children:e.brand}),s.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:e.name}),s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx("div",{className:"flex items-center",children:[...Array(5)].map((d,l)=>s.jsx(Pt,{size:14,className:l<Math.floor(e.rating)?"text-yellow-400 fill-current":"text-gray-300"},l))}),s.jsxs("span",{className:"text-xs text-gray-500",children:["(",e.reviews,")"]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[(()=>{const d=Number(e.discount_percentage??e.discount??0),l=Number(e.original_price??e.originalPrice??0),f=Number(e.price??0);return d>0&&l>f?s.jsxs("span",{className:"text-sm text-gray-400 line-through mr-2",children:["€",l.toFixed(2)]}):null})(),s.jsxs("span",{className:"text-xl font-bold text-gray-900",children:["€",Number(e.price??0).toFixed(2)]})]}),s.jsx(N.button,{onClick:d=>{d.stopPropagation(),t(e)},className:"p-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",whileHover:{scale:1.05},whileTap:{scale:.95},children:s.jsx(Ge,{size:20})})]})]})]})},Ia=()=>{var Q;const[e,t]=p.useState([]),[r,n]=p.useState([]),[o,a]=p.useState(!0),[i,c]=p.useState(null),[u,d]=p.useState(""),[l,f]=p.useState(""),[y,w]=p.useState("name"),[g,x]=p.useState("grid"),[h,S]=p.useState(!1),[j,_]=p.useState(null),[L,$]=p.useState(""),[A,k]=p.useState(""),[T,P]=p.useState(!1),{toggleFavorite:D,isFavorite:X}=Bn(),{addToCart:G}=mt(),ie=[{id:"",name:"Tutte le categorie"},{id:"t-shirt",name:"T-Shirt"},{id:"camicia",name:"Camicie"},{id:"maglione",name:"Maglioni"},{id:"felpa",name:"Felpe"},{id:"giacca",name:"Giacche"},{id:"pantaloni",name:"Pantaloni"},{id:"shorts",name:"Shorts"},{id:"gonna",name:"Gonne"},{id:"vestito",name:"Vestiti"},{id:"scarpe",name:"Scarpe"},{id:"accessori",name:"Accessori"}];p.useEffect(()=>{(async()=>{try{a(!0),c(null);const C={};l&&(C.category=l),u&&(C.q=u);const B=await Ut.getProducts(C);t(B),n(B)}catch(C){console.error("Error loading products:",C),c("Errore nel caricamento dei prodotti. Riprova più tardi.")}finally{a(!1)}})()},[l,u]),p.useEffect(()=>{let E=[...e];E.sort((C,B)=>{switch(y){case"price-low":return C.price-B.price;case"price-high":return B.price-C.price;case"rating":return B.rating-C.rating;case"name":default:return C.name.localeCompare(B.name)}}),n(E)},[e,y]),p.useEffect(()=>{const E=W=>(W||"").toLowerCase().normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").replace(/[^a-z0-9\s]/g,"").trim(),C=(r||[]).map(W=>W.id),B=Object.fromEntries((r||[]).map(W=>[E(W.name),W.id]));return window.visibleProductIds=C,window.visibleProductsMap=B,window.productsSearchQuery=u||"",window.productsSelectedCategory=l||"",window.applyProductFilters=({query:W,q:O,category:xe,sort:ye,price_range:ze}={})=>{const Be=W??O;typeof Be=="string"&&d(Be),typeof xe=="string"&&f(xe),typeof ye=="string"&&w(ye),ze==="low-to-high"&&w("price-low"),ze==="high-to-low"&&w("price-high"),window.scrollTo({top:0,behavior:"smooth"})},()=>{delete window.visibleProductIds,delete window.visibleProductsMap,delete window.applyProductFilters,delete window.productsSearchQuery,delete window.productsSelectedCategory}},[r,u,l,d,f,w]);const re=E=>{const C=new Set;return((E==null?void 0:E.variants)||[]).forEach(B=>{B.available&&C.add(B.size)}),Array.from(C)},Se=E=>{const C=new Set;return((E==null?void 0:E.variants)||[]).forEach(B=>{B.available&&C.add(B.color)}),Array.from(C)},ne=(E,C,B)=>((E==null?void 0:E.variants)||[]).some(O=>O.size===C&&O.color===B&&O.available),Xe=E=>{_(E);const C=re(E),B=Se(E),W=C[0]||"",O=B[0]||"";$(W),k(O),S(!0)},se=E=>{Xe(E)},Ie=async()=>{if(j&&!(!L||!A)&&ne(j,L,A))try{P(!0),await G(j,L,A,1),S(!1),_(null),console.log("Product added to cart:",j==null?void 0:j.name)}catch(E){console.error("Error adding to cart:",E)}finally{P(!1)}};return o?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Caricamento prodotti..."})]})}):s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[s.jsxs(N.div,{className:"mb-8",initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[s.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Prodotti"}),s.jsx("p",{className:"text-gray-600",children:"Scopri la nostra collezione di moda italiana"})]}),s.jsx(N.div,{className:"bg-white rounded-lg shadow-sm p-6 mb-8",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:s.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-center justify-between",children:[s.jsx("div",{className:"flex-1 max-w-md",children:s.jsx("input",{type:"text",placeholder:"Cerca prodotti...",value:u,onChange:E=>d(E.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Or,{size:20,className:"text-gray-500"}),s.jsx("select",{value:l,onChange:E=>f(E.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:ie.map(E=>s.jsx("option",{value:E.id,children:E.name},E.id))})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-gray-500",children:"Ordina per:"}),s.jsxs("select",{value:y,onChange:E=>w(E.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[s.jsx("option",{value:"name",children:"Nome"}),s.jsx("option",{value:"price-low",children:"Prezzo: Basso-Alto"}),s.jsx("option",{value:"price-high",children:"Prezzo: Alto-Basso"}),s.jsx("option",{value:"rating",children:"Valutazione"})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>x("grid"),className:`p-2 rounded ${g==="grid"?"bg-blue-100 text-blue-600":"text-gray-500"}`,children:s.jsx(cs,{size:20})}),s.jsx("button",{onClick:()=>x("list"),className:`p-2 rounded ${g==="list"?"bg-blue-100 text-blue-600":"text-gray-500"}`,children:s.jsx(ls,{size:20})})]})]})}),s.jsx("div",{className:"mb-6",children:s.jsxs("p",{className:"text-gray-600",children:[r.length," prodotti trovati",u&&` per "${u}"`,l&&` in ${(Q=ie.find(E=>E.id===l))==null?void 0:Q.name}`]})}),s.jsx(N.div,{className:`grid gap-6 ${g==="grid"?"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4":"grid-cols-1"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:r.map((E,C)=>s.jsx(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:C*.1},children:s.jsx(Pa,{product:E,onAddToCart:se,onToggleFavorite:D,isFavorite:X(E.id)})},E.id))}),r.length===0&&s.jsxs(N.div,{className:"text-center py-12",initial:{opacity:0},animate:{opacity:1},children:[s.jsx("div",{className:"text-gray-400 mb-4",children:s.jsx(Or,{size:64,className:"mx-auto"})}),s.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Nessun prodotto trovato"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Prova a modificare i filtri o la ricerca"}),s.jsx("button",{onClick:()=>{d(""),f("")},className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Rimuovi filtri"})]})]}),h&&j&&s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[s.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>S(!1)}),s.jsxs(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"relative bg-white rounded-2xl shadow-xl w-full max-w-md p-6 z-10",onClick:E=>E.stopPropagation(),children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:j.name}),s.jsx("p",{className:"text-sm text-gray-500",children:j.brand})]}),s.jsx("button",{onClick:()=>S(!1),className:"p-2 rounded-full hover:bg-gray-100",children:s.jsx(at,{size:18})})]}),s.jsxs("div",{className:"space-y-5",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Seleziona taglia"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:re(j).map(E=>s.jsx("button",{onClick:()=>$(E),className:`px-3 py-2 rounded-lg border text-sm font-medium ${L===E?"border-blue-600 text-blue-600 bg-blue-50":"border-gray-300 text-gray-700 hover:border-gray-400"}`,children:E},E))})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Seleziona colore"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:Se(j).map(E=>s.jsx("button",{onClick:()=>k(E),className:`px-3 py-2 rounded-lg border text-sm font-medium capitalize ${A===E?"border-blue-600 text-blue-600 bg-blue-50":"border-gray-300 text-gray-700 hover:border-gray-400"}`,children:E},E))})]}),s.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[s.jsxs("button",{onClick:Ie,disabled:T||!L||!A||!ne(j,L,A),className:"flex-1 inline-flex items-center justify-center gap-2 bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 disabled:opacity-60",children:[s.jsx(Ge,{size:18}),T?"Aggiungo...":"Aggiungi al carrello"]}),s.jsx("button",{onClick:()=>S(!1),className:"px-4 py-3 rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-50",children:"Annulla"})]})]})]})]})]})},za=({offer:e,onAddToCart:t})=>{const[r,n]=p.useState(!1);return s.jsxs(N.div,{className:"bg-white rounded-xl shadow-sm overflow-hidden cursor-pointer relative",whileHover:{y:-8,shadow:"xl"},transition:{type:"spring",stiffness:300},onHoverStart:()=>n(!0),onHoverEnd:()=>n(!1),children:[s.jsx("div",{className:"absolute top-4 left-4 z-10",children:s.jsxs(N.div,{className:"bg-red-500 text-white px-3 py-1 rounded-full text-sm font-bold flex items-center gap-1",initial:{rotate:-15},animate:{rotate:r?0:-15},children:[s.jsx(un,{size:14}),"-",e.discount,"%"]})}),s.jsxs("div",{className:"relative overflow-hidden h-72 bg-gray-100",children:[s.jsx(N.img,{src:e.image,alt:e.name,className:"w-full h-full object-cover",animate:{scale:r?1.1:1},transition:{duration:.3}}),s.jsx(N.div,{className:"absolute top-4 right-16",whileHover:{scale:1.2},whileTap:{scale:.9},children:s.jsx("button",{className:"p-2 bg-white rounded-full shadow-md hover:bg-gray-100",children:s.jsx(Ot,{size:20,className:"text-gray-600"})})})]}),s.jsxs("div",{className:"p-4",children:[s.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider mb-1",children:e.brand}),s.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:e.name}),s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx("div",{className:"flex items-center",children:[...Array(5)].map((o,a)=>s.jsx(Pt,{size:14,className:a<Math.floor(e.rating)?"text-yellow-400 fill-current":"text-gray-300"},a))}),s.jsxs("span",{className:"text-xs text-gray-500",children:["(",e.reviews,")"]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("span",{className:"text-sm text-gray-400 line-through mr-2",children:["€",Number(e.originalPrice??0).toFixed(2)]}),s.jsxs("span",{className:"text-xl font-bold text-red-600",children:["€",Number(e.price??0).toFixed(2)]}),s.jsxs("div",{className:"text-xs text-green-600 font-semibold",children:["Risparmi €",(Number(e.originalPrice??0)-Number(e.price??0)).toFixed(2)]})]}),s.jsx(N.button,{onClick:()=>t(e),className:"p-2 bg-red-600 text-white rounded-lg hover:bg-red-700",whileHover:{scale:1.05},whileTap:{scale:.95},children:s.jsx(Ge,{size:20})})]})]})]})},Fa=()=>{const[e,t]=p.useState([]),[r,n]=p.useState(!0),[o,a]=p.useState(null);p.useEffect(()=>{(async()=>{try{n(!0),a(null);const d=(await Ut.getProducts({on_sale:!0})).map((l,f)=>{var y;return{id:l.id,name:l.name,brand:l.brand,price:l.price,originalPrice:l.original_price,discount:l.discount_percentage,image:((y=l.images)==null?void 0:y[0])||"https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?w=400",rating:l.rating,reviews:l.reviews,category:l.category,variants:l.variants}});t(d)}catch(u){console.error("Error loading offers:",u),a("Errore nel caricamento delle offerte. Riprova più tardi.")}finally{n(!1)}})()},[]),p.useEffect(()=>{try{const c={};(e||[]).forEach(u=>{const d=(u.name||"").toLowerCase().normalize("NFKD").replace(/[^\w\s]/g,"").trim();d&&(c[d]=u.id)}),window.visibleProductsMap=c,window.visibleProductIds=(e||[]).map(u=>u.id),window.currentPageContext="offers"}catch{}return()=>{if(window.currentPageContext==="offers")try{delete window.visibleProductsMap,delete window.visibleProductIds,delete window.currentPageContext}catch{}}},[e]),p.useEffect(()=>{const c=u=>{};return window.addEventListener("offers-apply-filters",c),()=>window.removeEventListener("offers-apply-filters",c)},[]);const i=async c=>{var u;try{const d=(u=c.variants)==null?void 0:u[0];d&&(await na.addToCart(c.id,d.size,d.color,1),console.log("Offer added to cart:",c.name))}catch(d){console.error("Error adding offer to cart:",d)}};return r?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-red-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Caricamento offerte..."})]})}):s.jsx("div",{className:"min-h-screen bg-gray-50",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[s.jsxs(N.div,{className:"mb-8",initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[s.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Offerte Speciali"}),s.jsx("p",{className:"text-gray-600",children:"Scopri una selezione di prodotti in sconto"})]}),s.jsx("div",{className:"mb-6",children:s.jsxs("p",{className:"text-gray-600",children:[e.length," offerte disponibili"]})}),s.jsx(N.div,{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:e.map((c,u)=>s.jsx(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:u*.1},children:s.jsx(za,{offer:c,onAddToCart:i})},c.id))}),e.length===0&&s.jsxs(N.div,{className:"text-center py-12",initial:{opacity:0},animate:{opacity:1},children:[s.jsx("div",{className:"text-gray-400 mb-4",children:s.jsx(un,{size:64,className:"mx-auto"})}),s.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Nessuna offerta trovata"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Controlla di nuovo più tardi per nuove offerte"})]}),s.jsxs(N.div,{className:"mt-16 bg-gradient-to-r from-red-500 to-orange-500 rounded-xl p-8 text-white text-center",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:[s.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Non Perdere le Offerte!"}),s.jsx("p",{className:"text-xl mb-6 opacity-90",children:"Iscriviti alla newsletter per ricevere notifiche sulle offerte esclusive"}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 max-w-md mx-auto",children:[s.jsx("input",{type:"email",placeholder:"La tua email",className:"flex-1 px-4 py-3 rounded-lg text-gray-900 placeholder-gray-500"}),s.jsx("button",{className:"px-6 py-3 bg-white text-red-600 font-semibold rounded-lg hover:bg-gray-100",children:"Iscriviti"})]})]})]})})},La=({item:e,onUpdateQuantity:t,onRemove:r})=>{var c,u,d,l,f,y,w;const n=ct(),[o,a]=p.useState(!1),i=()=>{a(!0),setTimeout(()=>{r(e.id)},300)};return s.jsx(N.div,{className:`bg-white rounded-lg shadow-sm p-4 border ${o?"opacity-50":""}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.3},children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-lg overflow-hidden cursor-pointer",onClick:()=>{var g;(g=e==null?void 0:e.product)!=null&&g.id&&n(`/products/${e.product.id}`)},title:"Vai alla pagina prodotto",role:"button",children:s.jsx("img",{src:((u=(c=e.product)==null?void 0:c.images)==null?void 0:u[0])||((d=e.product)==null?void 0:d.image),alt:(l=e.product)==null?void 0:l.name,className:"w-full h-full object-cover"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:(f=e.product)==null?void 0:f.name}),s.jsx("p",{className:"text-sm text-gray-500 mb-2",children:(y=e.product)==null?void 0:y.brand}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[s.jsxs("span",{children:["Taglia: ",e.size]}),s.jsxs("span",{children:["Colore: ",e.color]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>t(e.id,e.quantity-1),disabled:e.quantity<=1,className:"p-1 rounded-full bg-gray-100 hover:bg-gray-200 disabled:opacity-50",children:s.jsx(fn,{size:16})}),s.jsx("span",{className:"w-8 text-center font-semibold",children:e.quantity}),s.jsx("button",{onClick:()=>t(e.id,e.quantity+1),disabled:e.quantity>=10,className:"p-1 rounded-full bg-gray-100 hover:bg-gray-200 disabled:opacity-50",children:s.jsx(pn,{size:16})})]}),s.jsx("div",{className:"text-right",children:s.jsxs("div",{className:"font-semibold text-gray-900",children:["€",((((w=e.product)==null?void 0:w.price)||0)*e.quantity).toFixed(2)]})}),s.jsx("button",{onClick:i,className:"p-2 text-red-500 hover:bg-red-50 rounded-lg",children:s.jsx(fs,{size:18})})]})})},Da=()=>{const e=ct(),{cart:t,cartTotal:r,cartCount:n,shipping:o,updateQuantity:a,removeFromCart:i,clearCart:c}=mt();p.useEffect(()=>{Array.isArray(t)&&Ue(t)},[t]);const u=r,d=r+o;return t.length===0?s.jsx("div",{className:"min-h-screen bg-gray-50",children:s.jsx("div",{className:"max-w-4xl mx-auto px-4 py-8",children:s.jsxs(N.div,{className:"text-center py-16",initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[s.jsx("div",{className:"text-gray-400 mb-6",children:s.jsx(Ge,{size:80,className:"mx-auto"})}),s.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Il tuo carrello è vuoto"}),s.jsx("p",{className:"text-gray-600 mb-8",children:"Aggiungi alcuni prodotti per iniziare lo shopping"}),s.jsx(N.button,{className:"px-8 py-4 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700",onClick:()=>e("/products"),whileHover:{scale:1.05},whileTap:{scale:.95},children:"Inizia Shopping"})]})})}):s.jsx("div",{className:"min-h-screen bg-gray-50",children:s.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[s.jsxs(N.div,{className:"mb-8",initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[s.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Carrello"}),s.jsxs("p",{className:"text-gray-600",children:[n," ",n===1?"articolo":"articoli"," nel carrello"]})]}),s.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[s.jsxs("div",{className:"lg:col-span-2",children:[s.jsxs(N.div,{className:"bg-white rounded-lg shadow-sm p-6 mb-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"I tuoi articoli"}),s.jsx("button",{onClick:c,className:"text-red-500 hover:text-red-700 text-sm font-medium",children:"Svuota carrello"})]}),s.jsx(lt,{children:s.jsx("div",{className:"space-y-4",children:t.map(l=>s.jsx(La,{item:l,onUpdateQuantity:a,onRemove:i},l.id))})})]}),s.jsxs(N.div,{className:"bg-blue-50 rounded-lg p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:[s.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[s.jsx(dn,{className:"text-blue-600",size:24}),s.jsx("h3",{className:"font-semibold text-gray-900",children:"Spedizione"})]}),s.jsx("p",{className:"text-gray-600 mb-2",children:o===0?"🎉 Spedizione gratuita! Il tuo ordine supera i 100€":`Aggiungi €${(100-u).toFixed(2)} per la spedizione gratuita`}),s.jsx("div",{className:"text-sm text-gray-500",children:"Consegna stimata: 3-5 giorni lavorativi"})]})]}),s.jsxs("div",{className:"lg:col-span-1",children:[s.jsxs(N.div,{className:"bg-white rounded-lg shadow-sm p-6 sticky top-8",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Riepilogo ordine"}),s.jsxs("div",{className:"space-y-4 mb-6",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Subtotale"}),s.jsxs("span",{className:"font-semibold",children:["€",u.toFixed(2)]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Spedizione"}),s.jsx("span",{className:"font-semibold",children:o===0?"Gratuita":`€${o.toFixed(2)}`})]}),s.jsx("div",{className:"border-t pt-4",children:s.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[s.jsx("span",{children:"Totale"}),s.jsxs("span",{children:["€",d.toFixed(2)]})]})})]}),s.jsxs(N.button,{className:"w-full py-4 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 mb-4 flex items-center justify-center gap-2",whileHover:{scale:1.02},whileTap:{scale:.98},children:[s.jsx(us,{size:20}),"Procedi al Checkout",s.jsx(ds,{size:20})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Pagamenti sicuri"}),s.jsxs("div",{className:"flex justify-center gap-2",children:[s.jsx("div",{className:"w-8 h-5 bg-gray-200 rounded text-xs flex items-center justify-center",children:"VISA"}),s.jsx("div",{className:"w-8 h-5 bg-gray-200 rounded text-xs flex items-center justify-center",children:"MC"}),s.jsx("div",{className:"w-8 h-5 bg-gray-200 rounded text-xs flex items-center justify-center",children:"PP"})]})]})]}),s.jsxs(N.div,{className:"bg-white rounded-lg shadow-sm p-6 mt-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Codice promozionale"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",placeholder:"Inserisci codice",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),s.jsx("button",{className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Applica"})]})]})]})]})]})})},Ua=()=>{var $;const{id:e}=ts(),t=ct(),{addToCart:r}=mt(),{toggleFavorite:n,isFavorite:o}=Bn(),[a,i]=p.useState(null),[c,u]=p.useState(!0),[d,l]=p.useState(null),[f,y]=p.useState(""),[w,g]=p.useState(""),[x,h]=p.useState(1),[S,j]=p.useState(0);p.useEffect(()=>(e&&(async()=>{try{u(!0),l(null);const k=await Ut.getProduct(e);i(k);const T=P=>(P||"").replace(/```[\s\S]*?```/g," ").replace(/`[^`]*`/g," ").replace(/[\*_~>#-]+/g," ").replace(/\[(.*?)\]\((.*?)\)/g,"$1").replace(/\s{2,}/g," ").trim();window.currentProductContext={id:k.id,name:k.name,description_text:T(k.description||k.description_long||""),category:k.category,gender:k.gender,variants:(k.variants||[]).map(P=>({size:P.size,color:P.color,available:P.available,stock:P.stock}))},k.variants&&k.variants.length>0&&(y(k.variants[0].size),g(k.variants[0].color))}catch(k){console.error("Error loading product:",k),l("Errore nel caricamento del prodotto")}finally{u(!1)}})(),()=>{var k;((k=window.currentProductContext)==null?void 0:k.id)===e&&delete window.currentProductContext}),[e]);const _=async()=>{if(!(!f||!w))try{await r(a,f,w,x)}catch(A){console.error("Error adding to cart:",A)}},L=()=>{a&&n(a)};return c?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-purple-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Caricamento prodotto..."})]})}):d||!a?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center p-8 bg-white rounded-lg shadow-md",children:[s.jsx("h2",{className:"text-2xl font-bold text-red-600 mb-4",children:"Errore!"}),s.jsx("p",{className:"text-gray-700 mb-6",children:d||"Prodotto non trovato"}),s.jsx("button",{onClick:()=>t("/products"),className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition duration-300",children:"Torna ai Prodotti"})]})}):s.jsx("div",{className:"min-h-screen bg-gray-50",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[s.jsxs(N.button,{onClick:()=>t(-1),className:"flex items-center text-gray-600 hover:text-gray-900 mb-6",whileHover:{x:-5},children:[s.jsx(ps,{size:20,className:"mr-2"}),"Torna indietro"]}),s.jsxs("div",{className:"grid lg:grid-cols-2 gap-12",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsx(N.div,{className:"aspect-square bg-white rounded-2xl overflow-hidden shadow-lg",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5},children:s.jsx("img",{src:fr((($=a.images)==null?void 0:$[S])||a.image||"/static/images/placeholder-lg.jpg"),alt:a.name,className:"w-full h-full object-cover"})}),a.images&&a.images.length>1&&s.jsx("div",{className:"grid grid-cols-4 gap-2",children:a.images.map((A,k)=>s.jsx(N.button,{onClick:()=>j(k),className:`aspect-square rounded-lg overflow-hidden ${S===k?"ring-2 ring-blue-500":""}`,whileHover:{scale:1.05},whileTap:{scale:.95},children:s.jsx("img",{src:fr(A),alt:`${a.name} ${k+1}`,className:"w-full h-full object-cover"})},k))})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:a.name}),s.jsx("p",{className:"text-lg text-gray-600 mb-4",children:a.brand}),s.jsxs("div",{className:"flex items-center mb-4",children:[s.jsx("div",{className:"flex text-yellow-400",children:[...Array(5)].map((A,k)=>s.jsx(Pt,{size:20,fill:k<Math.floor(a.rating)?"currentColor":"none",stroke:"currentColor"},k))}),s.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["(",a.reviews," recensioni)"]})]}),s.jsxs("div",{className:"mb-6",children:[Number(a.discount_percentage??0)>0&&Number(a.original_price??0)>Number(a.price??0)?s.jsxs("span",{className:"text-lg text-gray-400 line-through mr-2",children:["€",Number(a.original_price??0).toFixed(2)]}):null,s.jsxs("span",{className:"text-3xl font-bold text-gray-900",children:["€",Number(a.price??0).toFixed(2)]}),Number(a.discount_percentage??0)>0&&s.jsxs("span",{className:"ml-3 bg-red-500 text-white px-3 py-1 rounded-full text-sm font-bold",children:["-",Number(a.discount_percentage??0),"%"]})]})]}),a.variants&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Taglia"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:[...new Set(a.variants.map(A=>A.size))].map(A=>s.jsx(N.button,{onClick:()=>y(A),className:`px-4 py-2 border rounded-lg font-medium ${f===A?"border-blue-500 bg-blue-50 text-blue-600":"border-gray-300 text-gray-700 hover:border-gray-400"}`,whileHover:{scale:1.05},whileTap:{scale:.95},children:A},A))})]}),a.variants&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Colore"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:[...new Set(a.variants.map(A=>A.color))].map(A=>s.jsx(N.button,{onClick:()=>g(A),className:`px-4 py-2 border rounded-lg font-medium capitalize ${w===A?"border-blue-500 bg-blue-50 text-blue-600":"border-gray-300 text-gray-700 hover:border-gray-400"}`,whileHover:{scale:1.05},whileTap:{scale:.95},children:A},A))})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Quantità"}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(N.button,{onClick:()=>h(Math.max(1,x-1)),className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50",whileTap:{scale:.95},children:s.jsx(fn,{size:16})}),s.jsx("span",{className:"text-lg font-medium px-4",children:x}),s.jsx(N.button,{onClick:()=>h(x+1),className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50",whileTap:{scale:.95},children:s.jsx(pn,{size:16})})]})]}),s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{className:"flex space-x-4",children:[s.jsxs(N.button,{onClick:_,className:"flex-1 bg-blue-600 text-white py-4 px-6 rounded-lg font-semibold hover:bg-blue-700 flex items-center justify-center",whileHover:{scale:1.02},whileTap:{scale:.98},children:[s.jsx(Ge,{size:20,className:"mr-2"}),"Aggiungi al Carrello"]}),s.jsx(N.button,{onClick:L,className:`p-4 rounded-lg border-2 ${a&&o(a.id)?"border-red-500 bg-red-50 text-red-600":"border-gray-300 text-gray-600 hover:border-gray-400"}`,whileHover:{scale:1.05},whileTap:{scale:.95},children:s.jsx(Ot,{size:20,fill:a&&o(a.id)?"currentColor":"none"})})]})}),s.jsxs("div",{className:"grid grid-cols-1 gap-4 pt-6 border-t",children:[s.jsxs("div",{className:"flex items-center text-gray-600",children:[s.jsx(dn,{size:20,className:"mr-3"}),s.jsx("span",{children:"Spedizione gratuita sopra i €100"})]}),s.jsxs("div",{className:"flex items-center text-gray-600",children:[s.jsx(ms,{size:20,className:"mr-3"}),s.jsx("span",{children:"Reso gratuito entro 30 giorni"})]}),s.jsxs("div",{className:"flex items-center text-gray-600",children:[s.jsx(hs,{size:20,className:"mr-3"}),s.jsx("span",{children:"Pagamenti sicuri"})]})]})]})]})]})})},qa=({isListening:e,isProcessing:t,isConnected:r,isSpeaking:n,isExecutingFunction:o,currentFunction:a,messages:i,error:c,onClose:u,isAssistantActive:d})=>{const[l,f]=p.useState(!1);p.useEffect(()=>{if(e||t||n||o||c||d)f(!0);else{const x=setTimeout(()=>{f(!1)},2e3);return()=>clearTimeout(x)}},[e,t,n,o,c,d]);const w=c?{icon:at,text:"Errore - Clicca per chiudere",color:"bg-red-500",textColor:"text-white",animate:!1}:o?{icon:{navigate_to_page:gs,search_products:mn,add_to_cart:_t,get_cart_summary:_t,get_recommendations:ot}[a]||ln,text:"Eseguo comando...",color:"bg-green-500",textColor:"text-white",animate:!0}:n?{icon:hn,text:"AIVA sta parlando",color:"bg-purple-500",textColor:"text-white",animate:!0}:t?{icon:Kt,text:"",color:"bg-blue-500",textColor:"text-white",animate:!0}:e?{icon:We,text:"Ti sto ascoltando",color:"bg-blue-500",textColor:"text-white",animate:!0}:{icon:xs,text:"AIVA pronta",color:"bg-gray-700",textColor:"text-white",animate:!1},g=x=>{x.stopPropagation(),console.log("🔴 VoiceVisualizer: Closing assistant completely"),f(!1),u&&u()};return l?s.jsx(lt,{children:s.jsx(N.div,{initial:{opacity:0,y:-20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.9},className:"fixed top-6 left-0 right-0 z-[100]",style:{pointerEvents:"none"},children:s.jsxs("div",{className:"relative mx-auto",style:{width:"400px",maxWidth:"90vw",pointerEvents:"auto"},children:[s.jsx(N.div,{className:"bg-black/90 backdrop-blur-xl rounded-2xl border border-white/10 shadow-2xl",style:{height:"80px",width:"100%"},initial:{scale:.9},animate:{scale:1},transition:{type:"spring",damping:20},children:s.jsxs("div",{className:"flex items-center justify-between p-4 h-full",children:[s.jsxs("div",{className:"flex items-center space-x-4 flex-1",children:[s.jsxs("div",{className:"relative flex-shrink-0",children:[s.jsx(N.div,{className:`w-12 h-12 rounded-full ${w.color} flex items-center justify-center`,animate:w.animate?{scale:[1,1.1,1]}:{},transition:{duration:1.2,repeat:w.animate?1/0:0,ease:"easeInOut"},children:w.icon===Kt?s.jsx(Kt,{className:"w-6 h-6 text-white animate-spin"}):s.jsx(w.icon,{className:"w-6 h-6 text-white"})}),w.animate&&s.jsx(N.div,{className:`absolute inset-0 rounded-full ${w.color} opacity-40`,animate:{scale:[1,1.6],opacity:[.4,0]},transition:{duration:1.8,repeat:1/0,ease:"easeOut"}})]}),s.jsxs("div",{className:"flex flex-col min-w-0 flex-1",children:[s.jsx("span",{className:`font-medium text-sm ${w.textColor} truncate`,children:w.text}),s.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[s.jsx("div",{className:`w-2 h-2 rounded-full ${r?"bg-green-400":"bg-red-400"}`}),s.jsx("span",{className:"text-white/60 text-xs",children:r?"Connesso":"Connessione..."})]})]})]}),s.jsxs("div",{className:"flex items-center space-x-3 flex-shrink-0",children:[(e||n)&&s.jsx("div",{className:"flex items-center space-x-1",children:[...Array(4)].map((x,h)=>s.jsx(N.div,{className:`w-1 rounded-full ${e?"bg-blue-400":"bg-purple-400"}`,animate:{height:[6,18,6]},transition:{duration:.8,repeat:1/0,delay:h*.15,ease:"easeInOut"}},h))}),s.jsx(N.button,{onClick:g,className:"p-2 rounded-full bg-white/10 hover:bg-white/20 transition-colors flex-shrink-0",whileHover:{scale:1.1},whileTap:{scale:.95},title:"Chiudi assistente vocale",children:s.jsx(at,{className:"w-4 h-4 text-white/80"})})]})]})}),!1,o&&a&&s.jsx(N.div,{className:"absolute -bottom-8 left-1/2 transform -translate-x-1/2",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:s.jsxs("div",{className:"bg-green-500/90 text-white text-xs px-3 py-1 rounded-full backdrop-blur-sm",children:[a==="search_products"&&"🔍 Ricerca in corso",a==="add_to_cart"&&"🛒 Aggiunta al carrello",a==="navigate_to_page"&&"📍 Navigazione",!["search_products","add_to_cart","navigate_to_page"].includes(a)&&"⚡ Esecuzione"]})})]})})}):null},ar={},Ma=()=>{const[e,t]=p.useState(!1),[r,n]=p.useState(!1),[o,a]=p.useState([]),[i,c]=p.useState(!1),[u,d]=p.useState(!1),[l,f]=p.useState(null),[y,w]=p.useState(null),[g,x]=p.useState(""),[h,S]=p.useState(!1),[j,_]=p.useState(!0),[L,$]=p.useState(!1),[A,k]=p.useState(0),T=ct(),{addToCart:P,removeFromCart:D,clearCart:X,removeLastItem:G,updateQuantity:ie}=mt(),{setSearchQuery:re,filterProducts:Se,setMultipleFilters:ne,clearFilters:Xe}=ge(),se=p.useRef(null),Ie=p.useRef(`session-${Date.now()}-${Math.random().toString(36).substr(2,9)}`);p.useRef(null),p.useRef(0);const Q=p.useRef(null),E=p.useRef([]),C=p.useRef(!1);p.useEffect(()=>{C.current=i},[i]);const B=p.useRef(!1),W=p.useRef(null),O=p.useRef(null);p.useRef([]);const xe=p.useRef(null),ye=p.useRef(""),ze=p.useRef(!1),Be=p.useRef(!1),de=p.useRef([]),be=p.useRef(null),Ye=p.useRef(!1),Vn=p.useRef(!1),ce=p.useRef(!1),Wn=p.useRef(!1),He=p.useRef(Date.now()),br=p.useRef(""),_e=p.useRef(!1),ht=p.useRef(null),qt=p.useRef(null),gt=p.useRef(null),Jn=p.useRef(null),Ze=p.useRef(null),Gn=11e3,Qn=3e3,wr=["Se hai bisogno di altro, sono qui.","Ok! Buon proseguimento, chiamami se ti serve aiuto.","Resto a disposizione se ti serve altro."],et=p.useRef(null),Mt=p.useRef(null),xt=p.useRef(!1),Fe=p.useRef(null),U=p.useRef(!1),vr=p.useCallback(()=>{et.current&&(clearTimeout(et.current),et.current=null),Fe.current&&(clearTimeout(Fe.current),Fe.current=null)},[]),le=p.useRef(!1),Sr=p.useRef(!0),Oe=p.useRef(!1);p.useRef(!1);const $t=p.useRef(null),jr=p.useRef(0),Nr=p.useCallback(()=>{try{if(C.current)return;const b=Date.now();if(b-jr.current<2e3)return;const v=window.AudioContext||window.webkitAudioContext;$t.current||($t.current=new v);const R=$t.current,I=R.createOscillator(),z=R.createGain();I.type="sine",I.frequency.setValueAtTime(880,R.currentTime),z.gain.setValueAtTime(1e-4,R.currentTime),z.gain.exponentialRampToValueAtTime(.2,R.currentTime+.01),I.connect(z).connect(R.destination),I.start(),z.gain.exponentialRampToValueAtTime(1e-4,R.currentTime+.15),I.stop(R.currentTime+.18),jr.current=b}catch{}},[]),Kn=p.useCallback(async()=>{try{const b=window.AudioContext||window.webkitAudioContext;if(!b)return;qt.current||(qt.current=new b);const v=qt.current,R=await navigator.mediaDevices.getUserMedia({audio:!0});gt.current=R;const I=v.createMediaStreamSource(R),z=v.createAnalyser();z.fftSize=512,Jn.current=z,I.connect(z);let q=0;const J=.02,V=12,oe=new Uint8Array(z.fftSize),Ne=()=>{z.getByteTimeDomainData(oe);let Le=0;for(let te=0;te<oe.length;te++){const Ce=(oe[te]-128)/128;Le+=Ce*Ce}if(q=Math.sqrt(Le/oe.length)>J?q+1:0,q>=V){try{window.speechSynthesis.cancel()}catch{}de.current=[],ye.current="",Ye.current=!0,ze.current=!1,S(!1),le.current=!1,c(!1),C.current=!1,U.current=!1,Ve(),O.current&&O.current();return}Ze.current=requestAnimationFrame(Ne)};Ze.current=requestAnimationFrame(Ne)}catch{}},[]),Ve=p.useCallback(()=>{try{Ze.current&&cancelAnimationFrame(Ze.current)}catch{}Ze.current=null;try{gt.current&&gt.current.getTracks().forEach(b=>b.stop())}catch{}gt.current=null},[]),Bt=p.useCallback(()=>{if(Q.current)try{const b=Q.current;Q.current=null;try{b.onend=null}catch{}try{b.stop()}catch{}}catch{}t(!1)},[]);p.useEffect(()=>{le.current=h},[h]),p.useEffect(()=>{Sr.current=j},[j]),p.useEffect(()=>{Oe.current=u},[u]),p.useEffect(()=>{C.current=i},[i]),p.useEffect(()=>{Wn.current=r},[r]);const Cr=6e4,Xn=1e4,Er=p.useCallback(()=>{const b=["Ciao! Sono AIVA, il tuo personal shopper AI. Come posso aiutarti oggi?","Benvenuto! Sono qui per aiutarti a trovare l'outfit perfetto. Cosa stai cercando?","Eccomi! Sono AIVA, dimmi cosa posso fare per te.","Ciao! Sono pronta ad assisterti con il tuo shopping. Di cosa hai bisogno?"],v=["Eccomi di nuovo! Come posso aiutarti?","Bentornato! Cosa cerchi oggi?","Sono qui! Dimmi cosa ti serve."];return A===0?(k(1),b[Math.floor(Math.random()*b.length)]):v[Math.floor(Math.random()*v.length)]},[A]);p.useEffect(()=>{ce.current=L},[L]);const Ht=()=>"webkitSpeechRecognition"in window||"SpeechRecognition"in window,Rr=p.useCallback(()=>{const b=window.speechSynthesis.getVoices(),v=[{name:"Google italiano",lang:"it-IT",gender:"female"},{name:"Alice",lang:"it-IT"},{name:"Elsa",lang:"it-IT"},{name:"Carla",lang:"it-IT"},{name:"Microsoft Elsa",lang:"it-IT"},{name:"Microsoft Cosimo",lang:"it-IT"},{lang:"it-IT",gender:"female"},{lang:"it-IT"},{lang:"it"}];for(const I of v){const z=b.find(q=>{var Ne;const J=q.lang.toLowerCase().startsWith(((Ne=I.lang)==null?void 0:Ne.toLowerCase())||"it"),V=!I.name||q.name.toLowerCase().includes(I.name.toLowerCase()),oe=!I.gender||q.name.toLowerCase().includes("female")||q.name.toLowerCase().includes("donna")||q.name.toLowerCase().includes("alice")||q.name.toLowerCase().includes("elsa")||q.name.toLowerCase().includes("carla");return J&&V&&oe});if(z)return console.log("🎤 Selected voice:",z.name,z.lang),ht.current=z,z}const R=b.find(I=>I.lang.toLowerCase().startsWith("it"));return R?(console.log("🎤 Fallback Italian voice:",R.name),ht.current=R,R):null},[]);p.useEffect(()=>{const b=()=>{Rr()};return b(),window.speechSynthesis.onvoiceschanged!==void 0&&(window.speechSynthesis.onvoiceschanged=b),setTimeout(b,100),setTimeout(b,500),()=>{window.speechSynthesis.onvoiceschanged!==void 0&&(window.speechSynthesis.onvoiceschanged=null)}},[Rr]);const Tr=p.useCallback(b=>{const v=(b||"").split(new RegExp("(?<=[\\.!?])\\s+")).map(R=>R.trim()).filter(Boolean);return v.length?v:[(b||"").trim()].filter(Boolean)},[]),we=p.useCallback(()=>{!window.speechSynthesis.speaking&&!le.current&&de.current.length===0&&(U.current=!1,c(!1),C.current=!1,ce.current&&E.current.length===0&&O.current&&O.current())},[]),Vt=p.useCallback(async(b,v)=>{var R,I;if(console.log("🎯 Executing function:",b,v),d(!0),f(b),He.current=Date.now(),Q.current){try{Q.current.stop()}catch(z){console.log("Could not stop recognition:",z.message)}t(!1)}try{switch(await new Promise(z=>setTimeout(z,300)),b){case"navigate_to_page":case"navigate":const q={home:"/",prodotti:"/products",products:"/products",offerte:"/offers",offers:"/offers",carrello:"/cart",cart:"/cart",checkout:"/checkout"}[v.page]||"/";console.log("📍 Navigating to:",q),T(q),ye.current="",Ye.current=!1,H(q==="/cart"?"Ecco il carrello.":q==="/offers"?"Ecco le offerte.":"Ecco!",()=>{c(!1),C.current=!1,U.current=!1,O.current&&O.current()},!1,{enqueue:!1}),Jt(1e3);break;case"search_products":const J=v.query||"",V=v.filters||{};console.log("🔍 Searching:",J,"Filters:",V);const oe=!!V.on_sale,Ne=window.location.pathname;if(oe){Ne!=="/offers"&&T("/offers");try{window.dispatchEvent(new CustomEvent("offers-apply-filters",{detail:{filters:V,query:J}}))}catch{}}else Ne!=="/products"&&T("/products"),setTimeout(()=>{if(J){re(J);const Y=document.querySelector('input[placeholder="Cerca prodotti..."]');Y&&(Y.value=J,Y.dispatchEvent(new Event("input",{bubbles:!0})))}Object.keys(V).length>0&&(ne(V),v.applyUIFilters!==!1&&_r(V))},500);H("Ecco!",()=>{c(!1),C.current=!1,U.current=!1,O.current&&O.current()},!1,{enqueue:!1});break;case"apply_ui_filters":console.log("🎨 Applying UI filters:",v.filters),window.applyProductFilters?window.applyProductFilters(v.filters||{}):_r(v.filters||{}),H("Fatto.",()=>{c(!1),C.current=!1,U.current=!1,O.current&&O.current()},!1,{enqueue:!1});break;case"get_product_details":const Le=v.product_id;console.log("📦 Showing product:",Le),T(`/products/${Le}`),H("Ecco!",()=>{c(!1),C.current=!1,U.current=!1,O.current&&O.current()},!1,{enqueue:!1});break;case"open_product_by_name":{const Y=((v==null?void 0:v.name)||"").toLowerCase().trim(),te=(R=window.visibleProductsMap)==null?void 0:R[Y];te?(T(`/products/${te}`),Jt(800)):(T("/products"),setTimeout(()=>{window.applyProductFilters&&window.applyProductFilters({query:v==null?void 0:v.name})},300),Jt(800));break}case"add_to_cart":console.log("🛒 Adding to cart:",v);try{if(window.location.pathname.includes("/products/")){const te=v.size||"M",De=((ue="")=>{const Z={nero:"nero",black:"nero",bianco:"bianco",white:"bianco","blu navy":"blu navy",navy:"blu navy","blu scuro":"blu navy",blu:"blu",azzurro:"azzurro",rosso:"rosso",borgogna:"bordeaux",bordeaux:"bordeaux","verde oliva":"verde oliva",oliva:"verde oliva",verde:"verde","grigio melange":"grigio melange",melange:"grigio melange",antracite:"grigio antracite",grigio:"grigio",beige:"beige",panna:"panna",crema:"panna",cammello:"cammello",marrone:"marrone",rosa:"rosa",giallo:"giallo",viola:"viola"},Ee=(ue||"").toLowerCase(),wt=Object.keys(Z).sort((ee,Re)=>Re.length-ee.length);for(const ee of wt)if(Ee.includes(ee))return Z[ee];const K=Ee.split(/[\s/,-]+/).filter(Boolean);for(const ee of K)if(Z[ee])return Z[ee];return Ee||"nero"})(v.color||"nero");setTimeout(()=>{const ue=document.querySelectorAll("button");for(let Z of ue)if(Z.textContent.trim().toUpperCase()===te.toUpperCase()){Z.click();break}setTimeout(()=>{for(let Z of document.querySelectorAll("button"))if(Z.textContent.toLowerCase().includes(De.toLowerCase())){Z.click();break}setTimeout(()=>{const Z=Array.from(document.querySelectorAll("button")).find(Ee=>Ee.textContent.includes("Aggiungi al Carrello"));Z&&Z.click()},300)},300)},200)}else{const te={id:v.product_id||"550e8400-0001-41d4-a716-446655440001",name:v.product_name||"Prodotto",price:v.price||49.9,brand:"Fashion Brand"};await P(te,v.size||"M",v.color||"nero",v.quantity||1)}H("Aggiunto al carrello.",()=>{c(!1),C.current=!1,U.current=!1,O.current&&O.current()},!1,{enqueue:!1})}catch(Y){console.error("Error adding to cart:",Y),H("Non sono riuscita ad aggiungerlo al carrello.",()=>{c(!1),C.current=!1,U.current=!1,O.current&&O.current()},!1,{enqueue:!1})}break;case"remove_from_cart":{const{item_id:Y,product_name:te,size:Ce,color:De}=v||{};let ue=Y;if(!ue&&te){const Z=(Ee=>(Ee||"").toString().normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").toLowerCase().replace(/[^a-z0-9]+/g," ").trim())(`${te} ${Ce||""} ${De||""}`);ue=(I=window.cartItemsMap)==null?void 0:I[Z]}console.log("🗑️ Removing from cart:",ue||Y),ue?(await D(ue),H("Ok, rimosso dal carrello.")):H("Non trovo quel prodotto nel carrello. Puoi ripetere il nome o dirmi la taglia e il colore?");break}case"remove_last_cart_item":console.log("🗑️ Removing last cart item"),await G();break;case"update_cart_quantity":console.log("📝 Updating quantity:",v),v.item_id&&v.quantity&&await ie(v.item_id,v.quantity);break;case"get_cart_summary":case"view_cart":console.log("🛒 Opening cart"),T("/cart"),H("Ecco il carrello.",()=>{c(!1),C.current=!1,U.current=!1,O.current&&O.current()},!1,{enqueue:!1});break;case"clear_cart":console.log("🗑️ Clearing cart"),await X(),H("Carrello svuotato.",()=>{c(!1),C.current=!1,U.current=!1,O.current&&O.current()},!1,{enqueue:!1});break;case"get_current_promotions":case"show_offers":console.log("🏷️ Showing offers"),T("/offers"),H("Ecco le offerte.",()=>{c(!1),C.current=!1,U.current=!1,O.current&&O.current()},!1,{enqueue:!1});break;case"get_recommendations":console.log("💡 Getting recommendations"),T("/products"),setTimeout(()=>{const Y=new CustomEvent("show-recommendations");window.dispatchEvent(Y)},300);break;case"close_conversation":console.log("👋 Closing conversation"),Ae();break;case"get_size_guide":try{const Y=await Ut.getSizeGuide(v.category||"pantaloni"),te=[];for(const[Ce,De]of Object.entries(Y))te.push(`${Ce}: ${Object.entries(De).map(([ue,Z])=>`${ue}=${Z}`).join(", ")}`);H(`Ecco la guida taglie per ${v.category}: ${te.join(". ")}`,()=>{c(!1),C.current=!1,U.current=!1,O.current&&O.current()},!1,{enqueue:!1})}catch{H("Non sono riuscita a recuperare la guida taglie al momento.",()=>{c(!1),C.current=!1,U.current=!1,O.current&&O.current()},!1,{enqueue:!1})}break;default:console.warn("❓ Unknown function:",b)}}catch(z){console.error("❌ Error executing function:",z),w("Errore nell'esecuzione del comando")}finally{setTimeout(()=>{d(!1),f(null),je(),!h&&!window.speechSynthesis.speaking&&(U.current=!1,c(!1),C.current=!1,ce.current&&!_e.current&&E.current.length===0&&yt())},200)}},[T,P,D,X,G,ie,re,ne,h]),je=p.useCallback(()=>{if(Oe.current)return;const b=E.current.shift();b&&(Oe.current=!0,setTimeout(async()=>{try{await Vt(b.name,b.params)}finally{Oe.current=!1,E.current.length>0?je():ce.current&&!window.speechSynthesis.speaking&&!le.current&&!C.current&&O.current&&O.current()}},0))},[Vt]),_r=p.useCallback(b=>{console.log("🎨 Applying UI filters:",b),setTimeout(()=>{if(b.category){const v=document.querySelector("select");if(v){for(let R of v.options)if(R.value.toLowerCase()===b.category.toLowerCase()){v.value=R.value,v.dispatchEvent(new Event("change",{bubbles:!0}));break}}}if(b.price_range){const v=document.querySelectorAll("select")[1];v&&(b.price_range==="low-to-high"?v.value="price-low":b.price_range==="high-to-low"&&(v.value="price-high"),v.dispatchEvent(new Event("change",{bubbles:!0})))}Se(b)},300)},[Se]),Wt=p.useCallback(()=>{if(!Ht())return null;const b=window.SpeechRecognition||window.webkitSpeechRecognition,v=new b;return v.continuous=!1,v.interimResults=!0,v.lang="it-IT",v.maxAlternatives=1,v.onstart=()=>{console.log("🎤 Recognition started"),t(!0),w(null),_(!0),He.current=Date.now(),_e.current=!1,et.current||(et.current=setTimeout(()=>{!h&&!C.current&&H(wr[Math.floor(Math.random()*wr.length)],()=>{Fe.current=setTimeout(()=>{!h&&!C.current&&Ae()},Qn)})},Gn))},v.onresult=R=>{if(!le.current&&Sr.current){let I="",z="";for(let q=R.resultIndex;q<R.results.length;q++){const J=R.results[q][0].transcript;R.results[q].isFinal?I+=J:z+=J}z&&x(z),I&&(console.log("💬 User said:",I),vr(),Mt.current=null,xt.current=!1,x(I),bt(),Yn(I),Q.current&&Q.current.stop())}},v.onerror=R=>{R.error!=="aborted"&&R.error!=="no-speech"&&(R.error==="network"?w("Errore di connessione. Riprova."):w(`Errore microfono: ${R.error}`),t(!1))},v.onend=()=>{console.log("🔚 Recognition ended"),t(!1),ce.current&&!h&&!u&&!_e.current&&!C.current&&!window.speechSynthesis.speaking&&!U.current&&!Fe.current&&E.current.length===0&&setTimeout(()=>{ce.current&&!h&&!C.current&&!U.current&&!Fe.current&&yt()},500)},v},[h,j,u]),yt=p.useCallback(()=>{if(!(_e.current||!ce.current||le.current||Oe.current||C.current||E.current.length>0||window.speechSynthesis.speaking)){if(Mt.current||(Mt.current=`ls-${Date.now()}`,xt.current=!1),xt.current||(Nr(),xt.current=!0),_e.current=!0,Q.current){try{Q.current.stop()}catch{}Q.current=null}setTimeout(()=>{if(ce.current&&!le.current&&!Oe.current&&!C.current)try{Q.current=Wt(),Q.current&&Q.current.start()}catch(b){console.error("Failed to restart:",b)}_e.current=!1},220)}},[h,u,Wt,Nr]),Jt=p.useCallback((b=700)=>{setTimeout(()=>{ce.current&&!_e.current&&!window.speechSynthesis.speaking&&!le.current&&!C.current&&E.current.length===0&&O.current&&O.current()},b)},[]);p.useEffect(()=>{O.current=yt},[yt]);const Ae=p.useCallback(()=>{if(console.log("🛑 Stopping assistant"),Q.current){try{Q.current.stop()}catch{}Q.current=null}if("speechSynthesis"in window)try{window.speechSynthesis.cancel()}catch{}de.current=[],be.current&&(clearTimeout(be.current),be.current=null),xe.current&&(clearTimeout(xe.current),xe.current=null),vr(),typeof Ve=="function"&&Ve(),t(!1),S(!1),d(!1),c(!1),$(!1),_(!0),ce.current=!1,_e.current=!1,E.current=[],U.current=!1,c(!1),C.current=!1,console.log("✅ Assistant stopped")},[]),bt=p.useCallback(()=>{He.current=Date.now(),xe.current&&clearTimeout(xe.current),ce.current&&(xe.current=setTimeout(()=>{Date.now()-He.current>=Cr?(console.log("⏰ Inactivity timeout reached"),H("Sono ancora qui se hai bisogno. Dì qualcosa o chiuderò la conversazione.",()=>{setTimeout(()=>{Date.now()-He.current>=Cr+1e4&&Ae()},1e4)})):bt()},Xn))},[Ae]);window.__AIVA_SINGLETON__||(window.__AIVA_SINGLETON__={ws:null,listeners:new Set,queue:[],lastFnSigTs:new Map});const me=window.__AIVA_SINGLETON__;p.useEffect(()=>{if(me.ws&&me.ws.readyState===WebSocket.OPEN)console.log("🔌 WebSocket reusing existing connection"),n(!0),se.current=me.ws;else{const v=()=>{try{const R=sa(Ie.current);me.ws=R,R.onopen=()=>{if(console.log("🔌 WebSocket connected"),n(!0),se.current=R,me.queue&&me.queue.length){for(const I of me.queue)try{R.send(JSON.stringify(I))}catch{}me.queue=[]}},R.onmessage=I=>{try{const z=JSON.parse(I.data);me.listeners.forEach(q=>q(z))}catch(z){console.error("Parse error:",z)}},R.onerror=I=>{console.error("WebSocket error:",I)},R.onclose=()=>{console.log("WebSocket disconnected"),n(!1),se.current=null,me.ws=null;let I=0;(()=>{if(I>=5)return;I+=1;const q=Math.min(1e3*Math.pow(2,I),1e4);setTimeout(()=>{v()},q)})()}}catch(R){console.error("Connection failed:",R)}};v()}const b=v=>{if(W.current)try{W.current(v)}catch(R){console.error(R)}};return me.listeners.add(b),()=>{me.listeners.delete(b)}},[]);const Gt=b=>(b||"").replace(/```[\s\S]*?```/g," ").replace(/`[^`]*`/g," ").replace(/[\*_~>#-]+/g," ").replace(/\[(.*?)\]\((.*?)\)/g,"$1").replace(/\b\d+\s+(pezzi?|in\s+magazzino|disponibili)\b[^,.]*[.,]?/gi,"").replace(/(\btaglia\b[^.]*?)\s*(,\s*)?\b\d+\b[^.]*\./gi,"$1.").replace(/\bXXXL\b/gi,"ics ics ics elle").replace(/\bXXL\b/gi,"ics ics elle").replace(/\bXL\b/gi,"ics elle").replace(/\bXXS\b/gi,"ics ics esse").replace(/\bXS\b/gi,"ics esse").replace(/vuoi[^.?!]*(taglie|colori|materiali)[^.?!]*[.?!]/gi," ").replace(/\s{2,}/g," ").trim(),H=p.useCallback((b,v,R=!1,I={})=>{const{enqueue:z=!1}=I||{};if("speechSynthesis"in window)try{if(Bt(),S(!0),le.current=!0,R){try{window.speechSynthesis.cancel()}catch{}de.current=[]}if((z?Tr(Gt(b)):[Gt(b)]).forEach(J=>{if(!J)return;const V=new SpeechSynthesisUtterance(J);V.lang="it-IT",V.rate=1,V.pitch=1.1,V.volume=.9,ht.current&&(V.voice=ht.current),V.onstart=()=>{S(!0),le.current=!0,_(!1),Vn.current=!0,be.current&&(clearTimeout(be.current),be.current=null),Kn()},V.onend=()=>{if(de.current.shift(),de.current.length>0){const oe=de.current[0];try{oe&&window.speechSynthesis.speak(oe)}catch{}}de.current.length===0&&(Ve(),S(!1),le.current=!1,Be.current&&(Be.current=!1,we()),typeof v=="function"&&v())},de.current.push(V)}),!window.speechSynthesis.speaking){const J=de.current[0];J&&window.speechSynthesis.speak(J)}be.current||(be.current=setTimeout(()=>{!window.speechSynthesis.speaking&&de.current.length===0&&(S(!1),le.current=!1,we())},1500))}catch{}},[Bt,Tr,we]),Ar=p.useCallback(b=>{var v,R;if(ce.current){if(console.log("📨 WebSocket message:",b.type),Ye.current&&b.type!=="processing_start"){console.log("⏭️ Dropped stale WS message:",b.type);return}switch(a(I=>[...I,b]),He.current=Date.now(),b.type){case"processing_start":{c(!0),C.current=!0,_(!1),B.current=!1,Bt(),ye.current="",Ye.current=!1;break}case"function_start":break;case"stream_start":{ye.current="",ze.current=!0,Be.current=!1;break}case"text_chunk":{typeof b.content=="string"&&(ye.current+=(b.content||"")+" ");break}case"stream_complete":{ze.current=!1;const I=Gt(ye.current.trim());ye.current="",I?(B.current=!0,H(I,()=>{c(!1),C.current=!1,we()},!1,{enqueue:!1})):(c(!1),C.current=!1,we());break}case"function_complete":{const z=((V,oe)=>{try{return`${V}:${JSON.stringify(oe)}`}catch{return`${V}:<unserializable>`}})(b.function,b.parameters||{}),q=Date.now(),J=(((v=window.__AIVA_SINGLETON__)==null?void 0:v.lastFnSigTs)||new Map).get(z)||0;if(window.__AIVA_SINGLETON__){if(q-J<1500)break;window.__AIVA_SINGLETON__.lastFnSigTs.set(z,q)}if(c(!1),C.current=!1,b.function&&b.parameters){const V=(br.current||"").toLowerCase();if(/(carrello|svuota|rimuovi|togli|elenca|prodotti nel carrello)/.test(V)&&b.function==="navigate_to_page"&&((R=b.parameters)==null?void 0:R.page)==="prodotti")break;E.current.push({name:b.function,params:b.parameters})}else H("Ok. Puoi ripetere la richiesta con qualche dettaglio in più?",()=>{U.current=!1,we()},!1,{enqueue:!1});break}case"response":{b.message&&(c(!0),C.current=!0,B.current=!0,H(b.message,()=>{c(!1),C.current=!1,we()},!1,{enqueue:!1}));break}case"complete":{b.message?(B.current=!0,H(b.message,()=>{c(!1),C.current=!1,we()},!1,{enqueue:!1})):!ze.current&&de.current.length===0&&!window.speechSynthesis.speaking?(c(!1),C.current=!1,we()):(be.current&&clearTimeout(be.current),be.current=setTimeout(()=>{c(!1),C.current=!1,we()},1500)),E.current.length>0&&!Oe.current&&je();break}case"error":{try{window.speechSynthesis.cancel()}catch{}de.current=[],S(!1),le.current=!1,c(!1),C.current=!1,U.current=!1,w(b.message||"Errore"),we();break}}}},[H,Vt,Ae]);p.useEffect(()=>{W.current=Ar},[Ar]);const kr=p.useCallback(async b=>{var R;if(!((ar==null?void 0:ar.VITE_VERCEL_MODE)==="true"||typeof window<"u"&&window.VERCEL_MODE===!0)){const I=me.ws;if(I&&I.readyState===WebSocket.OPEN)try{I.send(JSON.stringify(b));return}catch(z){console.warn("WS send failed, fallback HTTP",z)}}try{if((b==null?void 0:b.type)==="voice_command"){const z=await(await fetch("/api/voice/command",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:b.text,context:b.context,session_id:(R=b.context)==null?void 0:R.session_id})})).json(),q=Array.isArray(z==null?void 0:z.events)?z.events:[];for(const J of q)try{W.current&&W.current(J)}catch{}}}catch(I){console.error("HTTP voice command failed",I),W.current&&W.current({type:"error",message:"Errore richiesta voce"})}},[]),Yn=p.useCallback(b=>{var Z,Ee,wt;if(!b.trim())return;if(br.current=b,le.current||window.speechSynthesis.speaking){try{window.speechSynthesis.cancel()}catch{}typeof Ve=="function"&&Ve(),de.current=[],ye.current="",Ye.current=!0,U.current=!1,c(!1),C.current=!1,S(!1),le.current=!1}if(U.current||C.current){console.log("🔒 Ignoro comando: turno in corso"),O.current&&O.current();return}if(Fe.current){console.log("⏳ Ignoro comando: chiusura in corso");return}U.current=!0;const v=b.toLowerCase(),R=/(apri|mostra|vai|portami).*(il\s+)?carrello|^carrello$/,I=/(apri|mostra|vai|portami).*(offerte|in offerta|sconti)|^(offerte|sconti|saldi)$/,z=/(torna|vai).*(home|pagina iniziale)|^home$/,q=/((apri|mostra|vai|portami).*(pagina\s+)?prodotti(?!.*carrello))|^tutti i prodotti$|^prodotti$|^catalogo$|^mostra tutto$|^mostrami tutto$/,J=/^(descrivi|descrizione|dettagli|info( prodotto)?)$/,V=/(elenca|leggi|dimmi|quali|mostra).*(prodotti|articoli).*(nel\s+)?carrello|cosa.*(c\s'?|è|ho).*(nel\s+)?carrello/,oe=/(svuota|svuotare|svuotalo|svuotami|rimuovi|togli|cancella).*(tutti|tutto)?.*(prodotti|articoli)?.*(dal\s+)?carrello/,Ne=/(?:mostra|apri).*(?:il\s+)?prodotto\s+(.+)/,Le=(K="")=>K.toString().normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").toLowerCase().replace(/[^a-z0-9]+/g," ").trim(),Y=/(aggiungi|metti|mettilo|mettila).*(nel\s+)?carrello(?::|\s|\,)*(?:.*?(taglia)\s+([xslm]{1,3}|xs|xxs|xl|xxl|s|m|l))?(?:.*?(colore)\s+([a-zà-ù\s]+))?/i,te={xs:"XS",xxs:"XXS",s:"S",m:"M",l:"L",xl:"XL",xxl:"XXL"},Ce={nero:"nero",black:"nero",bianco:"bianco",white:"bianco",blu:"blu","blu navy":"blu navy",navy:"blu navy","blu scuro":"blu navy",azzurro:"azzurro",rosso:"rosso",borgogna:"bordeaux",bordeaux:"bordeaux",verde:"verde","verde oliva":"verde oliva",oliva:"verde oliva",grigio:"grigio","grigio melange":"grigio melange",melange:"grigio melange",antracite:"grigio antracite",beige:"beige",panna:"panna",crema:"panna",cammello:"cammello",rosa:"rosa",marrone:"marrone",giallo:"giallo",viola:"viola"},De=(K="")=>{const ee=K.normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").toLowerCase().trim(),Re=Object.keys(Ce).sort((ke,Qt)=>Qt.length-ke.length);for(const ke of Re)if(ee.includes(ke))return Ce[ke];return ee||void 0};if(R.test(v)){U.current=!0,c(!0),C.current=!0,E.current.push({name:"get_cart_summary",params:{}}),je();return}if(V.test(v)){U.current=!0,c(!0),C.current=!0;const K=on(6);H(K,()=>{c(!1),C.current=!1,O.current&&O.current()},!1,{enqueue:!1});return}if(I.test(v)){U.current=!0,c(!0),C.current=!0,E.current.push({name:"show_offers",params:{}}),je();return}if(z.test(v)){U.current=!0,c(!0),C.current=!0,E.current.push({name:"navigate_to_page",params:{page:"home"}}),je();return}if(oe.test(v)){U.current=!0,c(!0),C.current=!0,E.current.push({name:"clear_cart",params:{}}),je();return}if(q.test(v)){U.current=!0,c(!0),C.current=!0,E.current.push({name:"navigate_to_page",params:{page:"prodotti"}}),je();return}if(J.test(v)&&((Z=window.currentProductContext)!=null&&Z.description_text)){U.current=!0,c(!0),C.current=!0;const ee=`${window.currentProductContext.name||"prodotto"}. ${window.currentProductContext.description_text}`.slice(0,900);H(ee,()=>{c(!1),C.current=!1,U.current=!1,O.current&&O.current()},!1,{enqueue:!1});return}if(Y.test(b)&&((Ee=window.currentProductContext)!=null&&Ee.id)){const K=b.match(Y),ee=((K==null?void 0:K[3])||"").toLowerCase(),Re=((K==null?void 0:K[4])||"").toLowerCase(),ke=te[ee]||void 0,Qt=De(Re)||void 0;U.current=!0,c(!0),C.current=!0,E.current.push({name:"add_to_cart",params:{product_id:window.currentProductContext.id,size:ke||"M",color:Qt||"nero",quantity:1}}),je();return}const ue=v.match(Ne);if(ue&&ue[1]){const K=Le(ue[1]),ee=window.visibleProductsMap||{};let Re=null;if(ee[K])Re=ee[K];else for(const ke of Object.keys(ee))if(ke.includes(K)){Re=ee[ke];break}if(Re){U.current=!0,c(!0),C.current=!0,E.current.push({name:"get_product_details",params:{product_id:Re}}),je();return}}if(V.test(v)){U.current=!0,c(!0),C.current=!0;const K=on(5);H(K,()=>{c(!1),C.current=!1,O.current&&O.current()},!1,{enqueue:!1});return}if(/(ciao|grazie.*|basta|chiudi|puoi andare|stop|non.*altro)/i.test(v)){H("Perfetto, alla prossima!",()=>Ae());return}a(K=>[...K,{type:"user",text:b,timestamp:new Date().toISOString()}]),x(""),kr({type:"voice_command",text:b,context:{session_id:Ie.current,timestamp:new Date().toISOString(),current_page:window.location.pathname,cart_count:((wt=window.cartSnapshot)==null?void 0:wt.length)??ge.getState().cartCount,cart:window.cartSnapshot||[],cart_items_map:window.cartItemsMap||{},preferences:ge.getState().preferences,session_count:A,current_product:window.currentProductContext||null,visible_products:window.visibleProductIds||[],visible_products_map:window.visibleProductsMap||{},ui_filters:{q:window.productsSearchQuery||"",category:window.productsSelectedCategory||""}}})},[kr,A,H,Ae]),Zn=p.useCallback(async()=>{if(console.log("🎤 Toggle listening:",e,"Active:",L),!Ht()){w("Browser non supporta il riconoscimento vocale");return}if(w(null),e||L)Ae();else{console.log("▶️ Starting assistant"),$(!0),ce.current=!0,_e.current=!1,bt();try{(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(R=>R.stop());const v=Er();H(v,()=>{setTimeout(()=>{ce.current&&!C.current&&!Oe.current&&!window.speechSynthesis.speaking&&O.current&&O.current()},250)},!0,{enqueue:!1}),U.current=!1}catch(b){console.error("Microphone error:",b),w("Permessi microfono negati"),$(!1),ce.current=!1}}},[e,L,Wt,H,Er,Ae,bt]);return p.useEffect(()=>()=>{Q.current&&Q.current.stop(),"speechSynthesis"in window&&window.speechSynthesis.cancel(),se.current&&se.current.close(),xe.current&&clearTimeout(xe.current)},[]),{isListening:e,isConnected:r,messages:o,isProcessing:i,isExecutingFunction:u,currentFunction:l,error:y,transcript:g,isSpeaking:h,isUserTurn:j,isAssistantActive:L,toggleListening:Zn,clearError:()=>w(null),browserSupportsSpeechRecognition:Ht()}},$a=({isListening:e,isConnected:t,error:r,onToggleListening:n,browserSupportsSpeechRecognition:o,isAssistantActive:a})=>{const[i,c]=p.useState(!1),u=()=>{if(!o){console.warn("Speech recognition not supported"),alert("Il riconoscimento vocale non è disponibile nel tuo browser. Prova con Chrome o Edge per la migliore esperienza.");return}n()},l=r?{bg:"bg-gradient-to-r from-red-500 to-red-600",pulse:!1,icon:ws,tooltip:"Errore - Clicca per riprovare"}:a?e?{bg:"bg-gradient-to-r from-blue-500 to-purple-500",pulse:!0,icon:We,tooltip:"In ascolto - Clicca per fermare"}:{bg:"bg-gradient-to-r from-purple-500 to-pink-500",pulse:!1,icon:hn,tooltip:"AIVA attiva - Clicca per chiudere"}:{bg:"bg-gradient-to-r from-blue-600 to-purple-600",pulse:!1,icon:We,tooltip:"Attiva AIVA - Il tuo Personal Shopper AI"};return s.jsxs(N.div,{className:"fixed bottom-4 right-4 md:bottom-8 md:right-8 z-[120] pointer-events-auto",style:{bottom:"calc(env(safe-area-inset-bottom, 0px) + 1rem)",right:"calc(env(safe-area-inset-right, 0px) + 1rem)"},initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.5,type:"spring",stiffness:260,damping:20},children:[s.jsxs(N.button,{onClick:u,onHoverStart:()=>c(!0),onHoverEnd:()=>c(!1),className:`relative group ${l.bg} p-6 rounded-full shadow-2xl text-white overflow-hidden`,whileHover:{scale:1.1},whileTap:{scale:.95},disabled:!1,children:[s.jsx(N.div,{className:"absolute inset-0 bg-gradient-to-r from-pink-500 via-purple-500 to-blue-500",animate:{backgroundPosition:l.pulse?["0% 50%","100% 50%","0% 50%"]:["0% 50%"]},transition:{duration:2,repeat:l.pulse?1/0:0,ease:"linear"},style:{backgroundSize:"200% 200%"}}),l.pulse&&s.jsxs(s.Fragment,{children:[s.jsx(N.span,{className:"absolute inset-0 rounded-full border-4 border-white",animate:{scale:[1,2.2],opacity:[.6,0]},transition:{duration:1.5,repeat:1/0,ease:"easeOut"}}),s.jsx(N.span,{className:"absolute inset-0 rounded-full border-4 border-white",animate:{scale:[1,2.2],opacity:[.6,0]},transition:{duration:1.5,repeat:1/0,ease:"easeOut",delay:.5}})]}),s.jsx(N.div,{className:"relative z-10",animate:{rotate:l.pulse?[0,10,-10,0]:0,scale:a?[1,1.1,1]:1},transition:{duration:.8,repeat:l.pulse?1/0:0},children:s.jsx(l.icon,{size:28})}),i&&t&&s.jsx(N.div,{className:"absolute -top-1 -right-1",initial:{scale:0},animate:{scale:1},exit:{scale:0},children:s.jsx(ot,{className:"text-yellow-300",size:20})})]}),s.jsx(lt,{children:i&&s.jsxs(N.div,{initial:{opacity:0,y:10,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.9},className:"absolute bottom-full mb-3 right-0 bg-gray-900 text-white text-sm py-2 px-4 rounded-lg whitespace-nowrap max-w-xs",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ot,{size:16,className:"text-yellow-300 flex-shrink-0"}),s.jsx("span",{children:l.tooltip})]}),s.jsx("div",{className:"absolute bottom-0 right-8 transform translate-y-1/2 rotate-45 w-2 h-2 bg-gray-900"})]})}),s.jsx("div",{className:`absolute bottom-1 right-1 w-3 h-3 rounded-full border-2 border-white ${t?"bg-green-400":"bg-yellow-400"}`,title:t?"Connesso":"In connessione..."}),r&&s.jsx(N.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"absolute bottom-full mb-2 right-0 bg-red-500 text-white text-sm py-2 px-4 rounded-lg whitespace-nowrap max-w-xs",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(at,{size:16}),s.jsx("span",{children:r})]})})]})},Ba=({cartItemsCount:e,isListening:t,onVoiceToggle:r})=>{const[n,o]=p.useState(!1),a=cn(),i=[{id:"products",label:"Prodotti",icon:"📦",path:"/products"},{id:"offers",label:"Offerte",icon:"🏷️",path:"/offers"},{id:"cart",label:"Carrello",icon:"🛒",path:"/cart",badge:e}],u=(()=>{const d=a.pathname;return d==="/"?"home":d==="/products"?"products":d==="/offers"?"offers":d==="/cart"?"cart":"home"})();return s.jsxs(N.nav,{className:"sticky top-0 z-40 bg-white shadow-sm",initial:{y:-100},animate:{y:0},transition:{type:"spring",stiffness:100},children:[s.jsx("div",{className:"max-w-7xl mx-auto px-4",children:s.jsxs("div",{className:"flex items-center justify-between h-16",children:[s.jsxs("div",{className:"flex items-center gap-8",children:[s.jsx(N.a,{href:"/",className:"text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-purple-600 cursor-pointer select-none",whileHover:{scale:1.05},style:{userSelect:"none",WebkitUserSelect:"none"},children:"AIVA Fashion"}),s.jsx("div",{className:"hidden md:flex items-center gap-6",children:i.map(d=>s.jsx("a",{href:d.path,className:`text-gray-700 hover:text-blue-600 transition ${u===d.id?"text-blue-600 font-semibold":""}`,children:d.label},d.id))})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("button",{className:"p-2 text-gray-600 hover:text-blue-600",children:s.jsx(mn,{size:20})}),s.jsx("button",{className:"p-2 text-gray-600 hover:text-blue-600",children:s.jsx(ys,{size:20})}),s.jsxs("a",{href:"/cart",className:"relative p-2 text-gray-600 hover:text-blue-600",children:[s.jsx(_t,{size:20}),e>0&&s.jsx(N.span,{initial:{scale:0},animate:{scale:1},className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:e})]}),s.jsx("button",{onClick:()=>o(!n),className:"md:hidden p-2 text-gray-600",children:n?s.jsx(at,{size:20}):s.jsx(bs,{size:20})})]})]})}),s.jsx(lt,{children:n&&s.jsx(N.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"md:hidden bg-white border-t",children:s.jsx("div",{className:"px-4 py-4 space-y-2",children:i.map(d=>s.jsxs("a",{href:d.path,className:`block py-2 px-3 rounded-lg text-gray-700 hover:text-blue-600 hover:bg-blue-50 ${u===d.id?"text-blue-600 font-semibold bg-blue-50":""}`,onClick:()=>o(!1),children:[s.jsx("span",{className:"mr-2",children:d.icon}),d.label,d.badge>0&&s.jsx("span",{className:"ml-2 bg-red-500 text-white text-xs rounded-full px-2 py-1",children:d.badge})]},d.id))})})})]})},Ha=()=>{const e=()=>{try{window.scrollTo({top:0,behavior:"smooth"})}catch{}};return s.jsxs("footer",{className:"bg-gray-900 text-gray-300 py-12 px-4",children:[s.jsxs("div",{className:"max-w-7xl mx-auto grid md:grid-cols-3 gap-8",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-white font-bold text-xl mb-4",children:"AIVA Fashion"}),s.jsx("p",{className:"text-sm",children:"Concept interattivo per portfolio – non è un e‑commerce reale."})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-white font-semibold mb-4",children:"Info"}),s.jsx("p",{className:"text-sm leading-6",children:"Questo sito è un progetto dimostrativo creato da Michele Miranda per mostrare integrazione tra assistente vocale, AI e interfaccia e‑commerce. I prodotti, i prezzi e le promozioni hanno scopo illustrativo."})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-white font-semibold mb-4",children:"Shop"}),s.jsxs("ul",{className:"space-y-2 text-sm",children:[s.jsx("li",{children:s.jsx("a",{href:"/products",className:"hover:text-white transition",children:"Prodotti"})}),s.jsx("li",{children:s.jsx("a",{href:"/offers",className:"hover:text-white transition",children:"Offerte"})}),s.jsx("li",{children:s.jsx("button",{onClick:e,className:"hover:text-white transition",children:"Torna Su"})})]})]})]}),s.jsx("div",{className:"max-w-7xl mx-auto mt-8 pt-8 border-t border-gray-800 text-center text-sm",children:s.jsx("p",{children:"© 2025 AIVA Fashion – Concept per il portfolio di Michele Miranda"})})]})};function Va(){const e=cn(),{cartCount:t}=mt(),{isListening:r,isConnected:n,messages:o,isProcessing:a,isExecutingFunction:i,currentFunction:c,error:u,isSpeaking:d,isAssistantActive:l,toggleListening:f,clearError:y,browserSupportsSpeechRecognition:w}=Ma();p.useEffect(()=>{if(u){const x=setTimeout(()=>{y()},5e3);return()=>clearTimeout(x)}},[u,y]);const g=()=>{console.log("🔴 App: Closing assistant completely"),f()};return s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsx(Ba,{cartItemsCount:t,isListening:r,onVoiceToggle:f}),s.jsx(lt,{mode:"wait",children:s.jsx(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:s.jsxs(rs,{children:[s.jsx(tt,{path:"/",element:s.jsx(Rs,{onVoiceToggle:f})}),s.jsx(tt,{path:"/products",element:s.jsx(Ia,{})}),s.jsx(tt,{path:"/products/:id",element:s.jsx(Ua,{})}),s.jsx(tt,{path:"/offers",element:s.jsx(Fa,{})}),s.jsx(tt,{path:"/cart",element:s.jsx(Da,{})})]})},e.pathname)}),s.jsx(Ha,{}),s.jsx($a,{isListening:r,isConnected:n,error:u,onToggleListening:f,browserSupportsSpeechRecognition:w,isAssistantActive:l}),l&&s.jsx(qa,{isListening:r,isProcessing:a,isConnected:n,isSpeaking:d,isExecutingFunction:i,currentFunction:c,messages:o,error:u,onClose:g,isAssistantActive:l})]})}var Wa=vs();const Hn=hr(Wa);typeof globalThis.regeneratorRuntime>"u"&&(globalThis.regeneratorRuntime=Hn);typeof window<"u"&&(window.regeneratorRuntime=Hn);console.log("Polyfills loaded successfully");const Ja=an.Fragment;Es.createRoot(document.getElementById("root")).render(s.jsx(Ja,{children:s.jsx(ns,{children:s.jsx(Va,{})})}));
//# sourceMappingURL=index-DWtFkBzA.js.map
